# 使用 AWX 用户、权限和组织

在阅读前一章时，你可能会问自己一些关于 AWX 安全的问题。

AWX 非常强大，要想如此强大，它需要大量访问目标机器，这意味着它可能成为安全链中潜在的薄弱环节。

在这一章中，我们将稍微讨论一下 AWX 用户、权限和组织；也就是说，我们将涵盖以下主题:

*   AWX 用户和权限
*   AWX 组织

# 技术要求

为了完成这一章，我们只需要 AWX，这是我们在上一章建立的。

# AWX 用户和权限

首先，如果你记得你第一次打开 AWX，你会记得你必须输入用户名和密码。

可以想象，这些都是默认凭据，但是您可以创建组织需要的所有用户。

为此，您可以转到左侧菜单中的用户部分，如下图所示:

![](assets/7822cc10-cb41-4c6e-85f8-2cdbb396510d.png)

如您所料，管理员用户在场，并且是唯一在场的用户。

我们可以通过点击带有+符号的绿色按钮来创建其他用户。

当我们创建新用户时，需要以下字段:

*   **名字**:这是用户的名字。
*   **姓氏**:用户的姓氏。
*   **组织**:用户所属的组织(这一点我们在本章后面会讲到)。
*   **邮箱**:这是用户的邮箱。
*   **用户名**:这是用户的用户名。这将用于登录，并在用户界面中弹出。
*   **密码**:这是用户的密码。
*   **确认密码**:重新输入密码，确保没有错别字溜进来。
*   **用户类型**:用户可以是普通用户、系统审计员、系统管理员。默认情况下，普通用户没有任何权限，如果没有明确授权的话。系统审计员可以看到整个系统的一切，但只能以只读模式查看。系统管理员对整个系统拥有完全的读写权限。

将用户创建为普通用户后，可以转到模板。如果您进入`Demo Job Template`的编辑模式，您会注意到一个权限部分，您可以在其中查看和设置能够查看和操作该作业模板的用户。您应该会看到如下截图所示的内容:

![](assets/e3c5dc3e-7ca2-4c72-a811-e11f3ed7061c.png)

通过单击带+符号的绿色按钮，将出现一个模式，您可以在其中选择(或搜索)要启用的用户，并可以选择访问级别，如下图所示:

![](assets/3f453db8-f42e-4cfd-a2fb-624915b4ff7f.png)

AWX 允许您在三种不同的访问级别之间进行选择:

*   **Admin** :这类用户可以看到作业模板以及用它创建的过去的作业，以后执行作业模板，编辑作业模板。
*   **执行**:这类用户能够看到作业模板以及用其创建的过去的作业，并在以后执行作业模板，但不能编辑作业模板。
*   **阅读**:这种用户能够看到作业模板和用它创建的过去的作业，但是不能执行也不能更改。

同样，用户可以看到、使用和管理作业模板，AWX 的所有其他类型的对象也可以拥有权限。

正如您可能想象的那样，如果您开始有几十个作业和几十个用户，您将花费大量时间来管理权限。为了帮助你，AWX 提出了团队的概念。

团队在左侧菜单的团队项目中是可管理的，并且基本上只是用户组，因此您可以从**自主访问控制** ( **DAC** )方法转移到**基于角色的访问控制** ( **RBAC** )方法，该方法可以更快地跟上组织变化和需求。

通过使用用户、团队和权限，您将能够在非常精细的级别上决定谁能够做什么。

# AWX 组织

在更复杂的组织中，通常属于非常不同的团队和业务单位的许多人共享同一个 AWX 安装。

在这种情况下，建立不同的 AWX 组织是有意义的。这允许更容易的权限，以及将一些权限管理从核心系统管理员团队委托给组织管理部门。此外，除了组织范围的角色(如组织管理员和组织审计员)之外，组织还允许对组织资源的垂直权限，如库存管理员(即组织拥有的所有库存的自动管理员)或项目管理员(即组织拥有的所有项目的自动管理员)。

如果您所在的公司有多个网站，您可以决定将所有网站集中在同一个 AWX 组织中(如果它们由同一个人管理，例如“网络组”)，或者您可以决定将它们拆分为多个 AWX 组织，每个网站一个。

这些组织带来的优势如下:

*   更轻松的权限管理
*   随着时间的推移，团队经理(即“网络小组”经理或单一网站经理)对董事会成员和非董事会成员的能力
*   更简单、更快速的审核，因为只需要审核与特定组织相关的权限，而不是 Tower 中的所有权限

由于这些优势，我总是建议您考虑如何使用 AWX 的 AWX 组织。

此外，根据我的经验，我一直注意到 AWX 组织的结构与公司结构越相似，它就越好，因为所有用户都会觉得它很自然。另一方面，如果你试图迫使一个 AWX 组织的结构与公司结构完全不同，这将感觉格格不入，会减缓 AWX 的采用速度，在同样的情况下，甚至会决定平台的失败。

# 摘要

在本书中，我们从自动化的一些非常基本的概念开始，比较了 Ansible 和其他常见的选项，如手动过程、bash 脚本、Puppet 和 Chef。然后，我们继续研究如何编写 YAML 文件，因为这是 Ansible 使用的格式，以及如何安装 Ansible。然后，我们继续前进，创建了我们的第一个 Ansible 驱动的安装(一对基本的 HTTP 服务器，由一个数据库服务器支持)。然后，我们添加了一些特性来利用 Ansible 的特性，例如变量、模板和任务委托。然后，我们继续前进，看看 Ansible 如何在云环境中为您提供帮助，例如 AWS、数字海洋和 Azure。然后，我们继续分析 Ansible 如何用于触发通知，以及在各种部署场景中。最后，我们概述了官方的 Ansible 图形界面:AWX/Ansible 塔。

得益于这些内容，您现在应该能够自动化您在 Ansible 使用中遇到的所有可能的场景。