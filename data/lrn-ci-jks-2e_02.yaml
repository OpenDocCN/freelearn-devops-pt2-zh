- en: Installing Jenkins
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安装 Jenkins
- en: 'This chapter is all about installing Jenkins across various platforms, and
    more. After completing this chapter, you should be able to do the following:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 本章讲述了如何在各种平台上安装 Jenkins 等内容。完成本章后，您应该能够做到以下几点：
- en: Run Jenkins on a servlet container (Apache Tomcat)
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 Servlet 容器（Apache Tomcat）上运行 Jenkins
- en: Run Jenkins as a standalone application on Windows/Ubuntu/Red Hat Linux/Fedora
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 Windows/Ubuntu/Red Hat Linux/Fedora 上以独立应用程序的形式运行 Jenkins
- en: Run Jenkins behind a reverse proxy server (Nginx)
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在反向代理服务器（Nginx）后运行 Jenkins
- en: Run Jenkins with Docker
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 Docker 运行 Jenkins
- en: Leverage the advantages of Docker data volumes
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 利用 Docker 数据卷的优势
- en: Run development, staging, and production instance of Jenkins using Docker
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 Docker 运行 Jenkins 的开发、分段和生产实例
- en: Running Jenkins inside a servlet container
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在 Servlet 容器内运行 Jenkins
- en: 'Jenkins is available on the following servlet containers:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: Jenkins 可用于以下 Servlet 容器：
- en: Apache Geronimo 3.0
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Apache Geronimo 3.0
- en: GlassFish
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: GlassFish
- en: IBM WebSphere
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: IBM WebSphere
- en: JBoss
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: JBoss
- en: Jetty
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Jetty
- en: Jonas
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Jonas
- en: Liberty profile
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Liberty profile
- en: Tomcat
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Tomcat
- en: WebLogic
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: WebLogic
- en: In this section, you will learn how to install Jenkins on an Apache Tomcat server.
    Installing Jenkins as a service on Apache Tomcat is quite simple. Either you can
    choose to run Jenkins along with the other services already present on the Apache
    Tomcat server, or you can use the Apache Tomcat server solely for running Jenkins.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，您将学习如何在 Apache Tomcat 服务器上安装 Jenkins。在 Apache Tomcat 上将 Jenkins 安装为服务相当简单。您可以选择将
    Jenkins 与 Apache Tomcat 服务器上已有的其他服务一起运行，或者您可以仅使用 Apache Tomcat 服务器来运行 Jenkins。
- en: Prerequisites
  id: totrans-20
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 先决条件
- en: 'Before you begin, make sure you have the following things ready:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 在开始之前，请确保您准备好以下事项：
- en: You need a system with at least 4 GB of memory and a Multi-core processor.
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 您需要一台至少拥有 4GB 内存和多核处理器的系统。
- en: Depending on how you manage the infrastructure in your team, the machine could
    be an instance on a cloud platform (such as AWS, DigitalOcean, or any other cloud
    platform), a bare metal machine, or it could be a VM (on VMware vSphere or any
    other server virtualization software).
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 根据团队中的基础设施管理方式，机器可以是云平台的实例（例如 AWS、DigitalOcean 或任何其他云平台）、裸金属机器，或者它可以是一个虚拟机（在
    VMware vSphere 或任何其他服务器虚拟化软件上）。
- en: The machine should have Ubuntu 16.04 installed on it. Choose an LTS release
    version.
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 机器应该安装有 Ubuntu 16.04。选择一个 LTS 版本。
- en: Check for administrator privileges; the installation might ask for an admin
    username and password.
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检查管理员权限；安装可能会要求管理员用户名和密码。
- en: Installing Java
  id: totrans-26
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安装 Java
- en: 'Follow these steps to install Java on Ubuntu:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下步骤在 Ubuntu 上安装 Java：
- en: 'Update the package index:'
  id: totrans-28
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 更新软件包索引：
- en: '[PRE0]'
  id: totrans-29
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Next, install Java. The following command will install the **Java Runtime Environment**
    (**JRE**):'
  id: totrans-30
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，安装 Java。执行以下命令将安装**Java Runtime Environment**（**JRE**）：
- en: '[PRE1]'
  id: totrans-31
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'To set the `JAVA_HOME` environment variable, get the Java installation location.
    Do this by executing the following command:'
  id: totrans-32
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要设置`JAVA_HOME`环境变量，请获取 Java 安装位置。通过执行以下命令来执行此操作：
- en: '[PRE2]'
  id: totrans-33
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'The previous command will print the list of Java applications installed on
    your machine along with their installation paths. Copy the Java path that appears
    on your Terminal:'
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 上一个命令将打印在您的机器上安装的 Java 应用程序列表以及它们的安装路径。复制在终端上出现的 Java 路径：
- en: '[PRE3]'
  id: totrans-35
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Open the `/etc/environment` file for editing using the following command:'
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令编辑`/etc/environment`文件：
- en: '[PRE4]'
  id: totrans-37
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Add the Java path (the one that you copied earlier) inside the `/etc/environment` file in
    the following format:'
  id: totrans-38
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`/etc/environment`文件中以以下格式添加 Java 路径（您之前复制的路径）：
- en: '[PRE5]'
  id: totrans-39
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Type *Ctrl* + *X* and choose *Y* to save and close the file.
  id: totrans-40
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入*Ctrl* + *X*并选择*Y*以保存并关闭文件。
- en: 'Next, reload the file using the following command:'
  id: totrans-41
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用以下命令重新加载文件：
- en: '[PRE6]'
  id: totrans-42
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Installing Apache Tomcat
  id: totrans-43
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安装 Apache Tomcat
- en: 'Follow these steps to download and then install Apache Tomcat server on your
    Ubuntu machine:'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下步骤下载并安装 Apache Tomcat 服务器到您的 Ubuntu 机器上：
- en: 'Move to the `/tmp` directory and download the Tomcat application using the
    `wget` command, as shown here:'
  id: totrans-45
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 移动到`/tmp`目录并使用`wget`命令下载 Tomcat 应用程序，如下所示：
- en: '[PRE7]'
  id: totrans-46
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: To get a complete list of Apache Tomcat versions visit: [https://archive.apache.org/dist/tomcat/](https://archive.apache.org/dist/tomcat/).
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 要获取完整的 Apache Tomcat 版本列表，请访问：[https://archive.apache.org/dist/tomcat/](https://archive.apache.org/dist/tomcat/)。
- en: 'Create a directory called `/opt/tomcat` using the following command:'
  id: totrans-48
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令创建一个名为`/opt/tomcat`的目录：
- en: '[PRE8]'
  id: totrans-49
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Untar the content of the archive inside `/opt/tomcat`:'
  id: totrans-50
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`/opt/tomcat`内解压存档的内容：
- en: '[PRE9]'
  id: totrans-51
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Next, create a `systemd` service file using the following command:'
  id: totrans-52
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用以下命令创建一个 `systemd` 服务文件：
- en: '[PRE10]'
  id: totrans-53
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'Paste the following content into the file:'
  id: totrans-54
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将以下内容粘贴到文件中：
- en: '[PRE11]'
  id: totrans-55
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Type *Ctrl* + *X* and choose *Y* to save and close the file.
  id: totrans-56
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入 *Ctrl* + *X* 并选择 *Y* 保存并关闭文件。
- en: 'Next, reload the systemd daemon using the following command:'
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用以下命令重新加载 systemd 守护程序：
- en: '[PRE12]'
  id: totrans-58
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'Start the Tomcat service using the following command:'
  id: totrans-59
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令启动 Tomcat 服务：
- en: '[PRE13]'
  id: totrans-60
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'To check the status of Tomcat service, run the following command:'
  id: totrans-61
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要检查 Tomcat 服务的状态，请运行以下命令：
- en: '[PRE14]'
  id: totrans-62
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'You should see the following output:'
  id: totrans-63
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您应该看到以下输出：
- en: '[PRE15]'
  id: totrans-64
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: Enabling the firewall and port 8080
  id: totrans-65
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 启用防火墙和端口 `8080`
- en: 'Apache Tomcat runs on port `8080`. Follow these steps to enable the firewall,
    if it''s disabled:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: Apache Tomcat 运行在端口 `8080` 上。如果防火墙已禁用，请按照以下步骤启用防火墙：
- en: 'Enable the firewall using the following command:'
  id: totrans-67
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令启用防火墙：
- en: '[PRE16]'
  id: totrans-68
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'Allow traffic on port `8080`:'
  id: totrans-69
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 允许端口 `8080` 上的流量：
- en: '[PRE17]'
  id: totrans-70
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'Enable OpenSSH to allow SSH connections using the following command:'
  id: totrans-71
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令启用 OpenSSH 以允许 SSH 连接：
- en: '[PRE18]'
  id: totrans-72
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'Check the firewall status using the following command:'
  id: totrans-73
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令检查防火墙状态：
- en: '[PRE19]'
  id: totrans-74
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'You should see the following output:'
  id: totrans-75
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您应该看到以下输出：
- en: '[PRE20]'
  id: totrans-76
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: You should now be able to access the Apache Tomcat server page at `http://<IP
    address of the Apache Tomcat>:8080`.
  id: totrans-77
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，您应该能够访问 Apache Tomcat 服务器页面：`http://<Apache Tomcat 的IP地址>:8080`。
- en: Configuring the Apache Tomcat server
  id: totrans-78
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 配置 Apache Tomcat 服务器
- en: 'In this section, we will enable access to the Tomcat Manager app and Host Manager:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将启用对 Tomcat 管理器应用程序和主机管理器的访问：
- en: 'Open the  `tomcat-users.xml` file for editing, which is present inside the
    `/opt/tomcat/conf` directory:'
  id: totrans-80
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开位于 `/opt/tomcat/conf` 目录内的 `tomcat-users.xml` 文件进行编辑：
- en: '[PRE21]'
  id: totrans-81
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'The file will look something like the following, for simplicity, I have ignored
    the comments inside the file:'
  id: totrans-82
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 文件将看起来像下面这样，为简单起见，我忽略了文件内的注释：
- en: '[PRE22]'
  id: totrans-83
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'From the previous file, you can see the `role` and `user` fields are commented.
    We need to enable a role and a user to allow access to the Tomcat Manager app
    page:'
  id: totrans-84
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从前一个文件中，您可以看到 `role` 和 `user` 字段被注释了。我们需要启用一个角色和一个用户来允许访问 Tomcat 管理器应用程序页面：
- en: '[PRE23]'
  id: totrans-85
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'Finally, the file should look something as shown here (comments removed):'
  id: totrans-86
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，文件应如下所示（已移除注释）：
- en: '[PRE24]'
  id: totrans-87
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: Type *Ctrl* + *X* and choose *Y* to save and close the file.
  id: totrans-88
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入 *Ctrl* + *X* 并选择 *Y* 保存并关闭文件。
- en: By default, you are allowed to access Manager and Host Manager applications
    only from within the Apache Tomcat server. Since, we will be managing services
    running on Apache from a remote machine, we would need to remove these restrictions.
  id: totrans-89
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 默认情况下，您只能从 Apache Tomcat 服务器内访问 Manager 和 Host Manager 应用程序。由于我们将从远程机器管理在 Apache
    上运行的服务，因此需要删除这些限制。
- en: Open the following two files, `/opt/tomcat/webapps/manager/META-INF/context.xml`
    and `/opt/tomcat/webapps/host-manager/META-INF/context.xml`.
  id: totrans-90
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开以下两个文件，`/opt/tomcat/webapps/manager/META-INF/context.xml` 和 `/opt/tomcat/webapps/host-manager/META-INF/context.xml`。
- en: 'Inside these files, comment the following section:'
  id: totrans-91
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在这些文件中，取消注释以下部分：
- en: '[PRE25]'
  id: totrans-92
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: Type *Ctrl* + *X* and choose *Y* to save and close the file.
  id: totrans-93
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入 *Ctrl* + *X* 并选择 *Y* 保存并关闭文件。
- en: 'Restart the Tomcat server using the following command:'
  id: totrans-94
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令重新启动 Tomcat 服务器：
- en: '[PRE26]'
  id: totrans-95
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: Try to access the Manager app and the Host Manager from the Apache Tomcat server
    home page.
  id: totrans-96
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 尝试从 Apache Tomcat 服务器主页访问管理器应用程序和主机管理器。
- en: Installing Jenkins on the Apache Tomcat server
  id: totrans-97
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在 Apache Tomcat 服务器上安装 Jenkins
- en: 'You can perform the following steps if you do not wish to have a standalone
    server for Jenkins master, and want to host it along with other services that
    exist on the Apache Tomcat server:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您不希望为 Jenkins 主服务器拥有独立的服务器，并希望将其与存在于 Apache Tomcat 服务器上的其他服务一起托管，可以执行以下步骤：
- en: 'Move to the `/tmp` directory and download the Jenkins application using the
    `wget` command, as shown here:'
  id: totrans-99
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 切换到 `/tmp` 目录，并使用 `wget` 命令下载 Jenkins 应用程序，如下所示：
- en: '[PRE27]'
  id: totrans-100
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: The previous command will download the latest stable version of `jenkins.war`
    file.
  id: totrans-101
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 前一个命令将下载最新稳定版本的 `jenkins.war` 文件。
- en: 'Move the file from `/tmp` to `/opt/tomcat/`:'
  id: totrans-102
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将文件从 `/tmp` 移动到 `/opt/tomcat/`：
- en: '[PRE28]'
  id: totrans-103
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: 'List the content of the `/opt/tomcat/webapps/` directory :'
  id: totrans-104
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 列出 `/opt/tomcat/webapps/` 目录的内容：
- en: '[PRE29]'
  id: totrans-105
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: 'You should see the following output:'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 您应该看到以下输出：
- en: '[PRE30]'
  id: totrans-107
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: You will notice that a `jenkins` folder automatically gets created the moment
    you move the `jenkins.war` package to the `webapps` folder. This is because the
    `.war` file is a web application archive file that automatically gets extracted
    once deployed to the `webapps` directory. What we did is a small deployment activity.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，将 `jenkins.war` 包移动到 `webapps` 文件夹时，会自动创建一个 `jenkins` 文件夹。这是因为 `.war` 文件是一个
    Web 应用程序存档文件，一旦部署到 `webapps` 目录中就会自动解压缩。我们所做的是一个小型的部署活动。
- en: And that is all you need to do. You can access Jenkins using `http://<IP address
    of Tomcat server>:8080/jenkins`.
  id: totrans-109
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 就是这样了。你可以使用`http://<Tomcat服务器的IP地址>:8080/jenkins`访问Jenkins。
- en: Installing Jenkins alone on an Apache Tomcat server
  id: totrans-110
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 仅在Apache Tomcat服务器上安装Jenkins
- en: 'If you chose to have an Apache Tomcat server solely for using Jenkins, follow
    these steps:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你选择为Jenkins使用单独的Apache Tomcat服务器，请按照以下步骤操作：
- en: 'Move to the `/tmp` directory and download the Jenkins application using the
    `wget` command, as shown here:'
  id: totrans-112
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 切换到`/tmp`目录并使用`wget`命令下载Jenkins应用程序，如下所示：
- en: '[PRE31]'
  id: totrans-113
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'Rename the downloaded `jenkins.war` package to `ROOT.war`:'
  id: totrans-114
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将下载的`jenkins.war`包重命名为`ROOT.war`：
- en: '[PRE32]'
  id: totrans-115
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: 'Next, delete everything inside the `/opt/tomcat/webapps` directory by switching
    to the `root` user:'
  id: totrans-116
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，通过切换到`root`用户删除`/opt/tomcat/webapps`目录中的所有内容：
- en: '[PRE33]'
  id: totrans-117
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'Now move the `ROOT.war` (renamed) package from the `/tmp` directory to the
    `/opt/tomcat/webapps` folder:'
  id: totrans-118
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在将`ROOT.war`（重命名）从`/tmp`目录移动到`/opt/tomcat/webapps`文件夹：
- en: '[PRE34]'
  id: totrans-119
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'List the contents of the `/opt/tomcat/webapps` directory and you will notice
    a `ROOT` folder automatically gets created:'
  id: totrans-120
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 列出`/opt/tomcat/webapps`目录的内容，你会注意到自动创建了一个`ROOT`文件夹：
- en: '[PRE35]'
  id: totrans-121
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: It's always recommended to have a dedicated web server solely for Jenkins.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 始终建议专门为Jenkins配置一个专用的Web服务器。
- en: You can access Jenkins by using `http://<IP address of Tomcat server>:8080/`
    without any additional path. Apparently, the Apache server is now a Jenkins server.
  id: totrans-123
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你可以通过`http://<Tomcat服务器的IP地址>:8080/`访问Jenkins，不需要任何额外路径。显然，Apache服务器现在是一个Jenkins服务器。
- en: Deleting the content of the `/opt/tomcat/webapps` directory (leaving behind
    the `ROOT` directory and `ROOT.war`) and then moving the `jenkins.war` file to
    the `webapps` folder is also sufficient to make Apache Tomcat server solely for
    the use of Jenkins.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 删除`/opt/tomcat/webapps`目录下的所有内容（保留`ROOT`目录和`ROOT.war`），然后将`jenkins.war`文件移动到`webapps`文件夹，这样就足以将Apache
    Tomcat服务器单独用于Jenkins。
- en: The step of renaming `jenkins.war` to `ROOT.war` is only necessary if you want
    to make `http://<IP address of Tomcat server>:8080/` the standard URL for Jenkins.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 将`jenkins.war`重命名为`ROOT.war`的步骤仅在你想要使`http://<Tomcat服务器的IP地址>:8080/`成为Jenkins的标准URL时才有必要。
- en: Setting up the Jenkins home path
  id: totrans-126
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 设置Jenkins主目录路径
- en: Before we start using Jenkins, there is one important thing to configure, the
    `jenkins_home` path. When you install Jenkins as a service on Tomcat, the `jenkins_home`
    path is automatically set to `/root/.jenkins/`. This is the location where all
    of the Jenkins configurations, logs, and builds are stored. Everything that you
    create and configure on the Jenkins dashboard is stored here.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 在开始使用Jenkins之前，有一件重要的事情要配置，即`jenkins_home`路径。当你在Tomcat上安装Jenkins作为服务时，`jenkins_home`路径将自动设置为`/root/.jenkins/`。这是所有Jenkins配置、日志和构建存储的位置。你在Jenkins仪表板上创建和配置的所有内容都存储在这里。
- en: 'We need to make it something more accessible, something like `/var/jenkins_home`.
    This can be done in the following way:'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 我们需要使其更易访问，比如`/var/jenkins_home`。可以按照以下方式实现：
- en: 'Stop the Apache Tomcat server using the following command:'
  id: totrans-129
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令停止Apache Tomcat服务器：
- en: '[PRE36]'
  id: totrans-130
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: 'Open the `context.xml` file for editing, which is present inside `/opt/tomcat/conf`:'
  id: totrans-131
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开`/opt/tomcat/conf`中的`context.xml`文件进行编辑：
- en: '[PRE37]'
  id: totrans-132
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: 'The file will look like this (comments removed):'
  id: totrans-133
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 文件看起来是这样的（注释已删除）：
- en: '[PRE38]'
  id: totrans-134
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: 'Add the following line between `<Context> </Context>`:'
  id: totrans-135
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`<Context> </Context>`之间添加以下行：
- en: '[PRE39]'
  id: totrans-136
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: 'Start the Tomcat service using the following command:'
  id: totrans-137
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令启动Tomcat服务：
- en: '[PRE40]'
  id: totrans-138
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: Installing a standalone Jenkins server on Windows
  id: totrans-139
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在Windows上安装独立的Jenkins服务器
- en: Installing Jenkins on Windows is quite simple. Before performing the steps to
    install Jenkins on Windows, let's have a look at the prerequisites.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 在Windows上安装Jenkins非常简单。在执行在Windows上安装Jenkins的步骤之前，让我们先看看先决条件。
- en: Prerequisites
  id: totrans-141
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 先决条件
- en: 'Before we begin, make sure you have the following things ready:'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 在开始之前，请确保您已准备好以下事项：
- en: We need a machine with at least 4 GB of RAM and a Multi-core processor.
  id: totrans-143
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们需要一台至少具有4 GB RAM和多核处理器的机器。
- en: Depending on how you manage the infrastructure in your team, the machine could
    be an instance on a cloud platform (such as AWS, DigitalOcean, or any other cloud
    platform), a bare metal machine, or it could be a VM (on VMware vSphere or any
    other server virtualization software).
  id: totrans-144
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 根据团队中对基础设施的管理方式，该机器可以是云平台上的一个实例（如AWS、DigitalOcean或任何其他云平台）、裸金属机器，或者是一个VM（在VMware
    vSphere或其他服务器虚拟化软件上）。
- en: The machine should have any one of the latest Windows OS (Windows 7/8/10, Windows
    Server 2012/2012 R2/2016) installed on it.
  id: totrans-145
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 机器上需要安装最新的任一Windows操作系统（Windows 7/8/10，Windows Server 2012/2012 R2/2016）。
- en: Check for admin privileges; the installation might ask for admin username and
    password.
  id: totrans-146
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检查管理员权限；安装可能会要求管理员用户名和密码。
- en: Make sure port `8080` is open.
  id: totrans-147
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确保端口`8080`处于开放状态。
- en: Installing Java
  id: totrans-148
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安装Java
- en: 'Follow these steps to install Java:'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下步骤安装Java：
- en: Download the latest version of Java JRE (x86 or x64 based on your OS) from [https://java.com/en/download/manual.jsp](https://java.com/en/download/manual.jsp).
  id: totrans-150
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从[https://java.com/en/download/manual.jsp](https://java.com/en/download/manual.jsp)下载最新版本的Java
    JRE（根据您的操作系统选择x86或x64）。
- en: Follow the installation procedures.
  id: totrans-151
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按照安装步骤操作。
- en: 'To check that Java has been installed successfully, run the following command
    using Command Prompt:'
  id: totrans-152
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要检查Java是否成功安装，请使用命令提示符运行以下命令：
- en: '[PRE41]'
  id: totrans-153
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: 'You should get the following output:'
  id: totrans-154
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您应该获得以下输出：
- en: '[PRE42]'
  id: totrans-155
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: 'To set the `JAVA_HOME`, first get the Java installation path on Windows using
    the following command:'
  id: totrans-156
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '要设置`JAVA_HOME`，首先使用以下命令获取Windows上的Java安装路径： '
- en: '[PRE43]'
  id: totrans-157
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: 'The previous command should output the Java installation path, as shown in
    the following command. Copy the path without `\bin\java`:'
  id: totrans-158
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 上一个命令应输出Java安装路径，如下所示。复制路径但不包括`\bin\java`：
- en: '[PRE44]'
  id: totrans-159
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: 'Open the Command Prompt as an administrator and run the following command to
    set the `JAVA_HOME` path. Make sure to use the Java installation path that appears
    on your screen:'
  id: totrans-160
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以管理员身份打开命令提示符，并运行以下命令以设置`JAVA_HOME`路径。确保使用屏幕上显示的Java安装路径：
- en: '[PRE45]'
  id: totrans-161
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: Installing the latest stable version of Jenkins
  id: totrans-162
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安装最新稳定版本的Jenkins
- en: 'To install the latest stable version of Jenkins, follow these steps in sequence:'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 要安装最新稳定版本的Jenkins，请按照以下步骤顺序执行：
- en: Download the latest stable Jenkins package available at the Jenkins official
    website, [https://jenkins.io/download/](https://jenkins.io/download/). To install
    the latest stable version of Jenkins, download the **Long Term Support** (**LTS**) release.
    Choose the weekly release if you just want the latest version of Jenkins.
  id: totrans-164
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在Jenkins官方网站[https://jenkins.io/download/](https://jenkins.io/download/)上下载最新稳定的Jenkins软件包。要安装最新稳定版本的Jenkins，请下载**长期支持**（**LTS**）版本。如果只想要最新版本的Jenkins，则选择周更版。
- en: Unzip the downloaded package, and you will find a `jenkins.msi` file.
  id: totrans-165
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 解压下载的软件包，您将找到一个`jenkins.msi`文件。
- en: Run the `jenkins.msi` and follow the installation steps.
  id: totrans-166
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行`jenkins.msi`并按照安装步骤操作。
- en: During the installation, you will get an option to choose your Jenkins installation
    directory. By default, it will be `C:\Program Files\Jenkins` or `C:\Program Files
    (x86)\Jenkins`. Leave it as it is and click on the Next button.
  id: totrans-167
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在安装过程中，您将有选择Jenkins安装目录的选项。默认情况下，它将是`C:\Program Files\Jenkins`或`C:\Program Files
    (x86)\Jenkins`。保持默认设置，然后单击**下一步**按钮。
- en: Click on the Finish button to complete the installation.
  id: totrans-168
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 单击**完成**按钮完成安装。
- en: Starting, stopping, and restarting Jenkins on Windows
  id: totrans-169
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在Windows上启动、停止和重启Jenkins
- en: 'Jenkins by default starts running when installed. In this section, the commands
    to start, stop, restart, and check the status of the Jenkins services are shown:'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: Jenkins默认在安装时开始运行。在本节中，显示了启动、停止、重启和检查Jenkins服务状态的命令：
- en: 'Open the Services window from Command Prompt using the following command:'
  id: totrans-171
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过以下命令从命令提示符中打开**服务**窗口：
- en: '[PRE46]'
  id: totrans-172
  prefs: []
  type: TYPE_PRE
  zh: '[PRE46]'
- en: Look for a service named Jenkins.
  id: totrans-173
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 寻找名为Jenkins的服务。
- en: Right-click on the Jenkins service again and click Properties.
  id: totrans-174
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 再次右键单击Jenkins服务，然后单击**属性**。
- en: Under the General tab, you can see the Jenkins service name, the path to the
    executable, the service status, and the start parameters.
  id: totrans-175
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**常规**选项卡下，您可以看到Jenkins服务名称、可执行文件路径、服务状态和启动参数。
- en: Using the Startup type option, you can choose the way Jenkins starts on the
    Windows machine. You can choose from Automatic, Manual, and Automatic (Delayed
    Start). Make sure it's always set to Automatic.
  id: totrans-176
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用**启动类型**选项，您可以选择Jenkins在Windows机器上启动的方式。您可以选择自动、手动和自动（延迟启动）中的一种。确保它始终设置为自动。
- en: 'In the following service status, there is an option to manually Start, Stop,
    Pause, and Resume the Jenkins service:'
  id: totrans-177
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在以下服务状态中，有手动**启动**、**停止**、**暂停**和**恢复**Jenkins服务的选项：
- en: '![](img/2e09bb15-a5f1-4ba8-9b45-715f0854e770.png)'
  id: totrans-178
  prefs: []
  type: TYPE_IMG
  zh: '![](img/2e09bb15-a5f1-4ba8-9b45-715f0854e770.png)'
- en: Configuring the Jenkins service startup option
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 配置Jenkins服务的启动选项
- en: Go to the next tab, which is Log On. Here, we define the username through which
    Jenkins start.
  id: totrans-180
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 转到下一个标签，即**登录**。在这里，我们通过Jenkins启动的用户名。
- en: 'You can either choose to use the Local System account (not recommended) or
    you can create a special Jenkins user with special permissions (recommended):'
  id: totrans-181
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您可以选择使用本地系统帐户（不推荐），或者您可以创建一个具有特殊权限的特殊Jenkins用户（推荐）：
- en: An exclusive account for Jenkins is always preferred. The reason is that Local
    System account is not under control; it may get deleted or the password may expire
    depending on the organization's policies, whereas the Jenkins user account can
    be set with preferred policies and privileges.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 对于 Jenkins，始终首选专用帐户。原因是 Local System 帐户 无法受控制；根据组织的政策，它可能会被删除或密码可能会过期，而 Jenkins
    用户帐户可以设置为首选策略和特权。
- en: '![](img/cfea67b3-bd34-479b-8a40-e3fa38068f7c.png)'
  id: totrans-183
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/cfea67b3-bd34-479b-8a40-e3fa38068f7c.png)'
- en: Configuring the Jenkins service Log On option
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 配置 Jenkins 服务的登录选项
- en: The next tab is Recovery. Here, we can specify the action items in case the
    Jenkins service fails to start.
  id: totrans-185
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下一个选项卡是 Recovery。在这里，我们可以指定 Jenkins 服务启动失败时的操作项目。
- en: 'Here is an example. At the first failure, there is an attempt to restart Jenkins,
    at the second failure an attempt is made to restart the computer. And lastly,
    at subsequent failures, a program is run to debug the issue, or we can run a script
    that sends the Jenkins failure log through email to the respective Jenkins admin
    for investigation:'
  id: totrans-186
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 这里有一个例子。在第一次失败时，尝试重新启动 Jenkins，在第二次失败时，尝试重新启动计算机。最后，在随后的失败中，运行一个程序来调试问题，或者我们可以运行一个脚本，将
    Jenkins 失败日志通过电子邮件发送给相应的 Jenkins 管理员进行调查：
- en: '![](img/be84fa4e-a90c-434f-9438-842c06375f60.png)'
  id: totrans-187
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/be84fa4e-a90c-434f-9438-842c06375f60.png)'
- en: Configuring the Jenkins service Recovery option
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 配置 Jenkins 服务的恢复选项
- en: Installing a standalone Jenkins server on Ubuntu
  id: totrans-189
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在 Ubuntu 上安装独立的 Jenkins 服务器
- en: Installing a Jenkins server on Ubuntu is quite easy. Before performing the steps
    to install Jenkins on Ubuntu, let's have a look at the prerequisites.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Ubuntu 上安装 Jenkins 服务器相当容易。在执行在 Ubuntu 上安装 Jenkins 的步骤之前，让我们先看看先决条件。
- en: Prerequisites
  id: totrans-191
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 先决条件
- en: 'Before we begin, make sure you have the following things ready:'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 在开始之前，请确保您准备好了以下事项：
- en: We need a machine with at least 4 GB of RAM and a Multi-core processor.
  id: totrans-193
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们需要一台至少有 4GB RAM 和多核处理器的机器。
- en: Depending on how you manage the infrastructure in your team, the machine could
    be an instance on a cloud platform (such as AWS, DigitalOcean, or any other cloud
    platform), a bare metal machine, or it could be a VM (on VMware vSphere or any
    other server virtualization software).
  id: totrans-194
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 根据您团队中如何管理基础设施，该机器可以是云平台上的实例（如 AWS、DigitalOcean 或任何其他云平台）、裸金属机器，或者它可以是一个 VM（在
    VMware vSphere 或任何其他服务器虚拟化软件上）。
- en: The machine should have Ubuntu 16.04 installed on it. Choose a LTS release version.
  id: totrans-195
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 机器应该安装了 Ubuntu 16.04。选择一个 LTS 发行版本。
- en: Check for admin privileges; the installation might ask for an admin username
    and password.
  id: totrans-196
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检查管理员特权；安装可能会要求输入管理员用户名和密码。
- en: Make sure port `8080` is open.
  id: totrans-197
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确保端口`8080`是开放的。
- en: Installing Java
  id: totrans-198
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安装 Java
- en: 'Follow these steps to install Java:'
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下步骤安装 Java：
- en: 'Update the package index using following command:'
  id: totrans-200
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令更新软件包索引：
- en: '[PRE47]'
  id: totrans-201
  prefs: []
  type: TYPE_PRE
  zh: '[PRE47]'
- en: 'Next, install Java. The following command will install the JRE:'
  id: totrans-202
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，安装 Java。以下命令将安装 JRE：
- en: '[PRE48]'
  id: totrans-203
  prefs: []
  type: TYPE_PRE
  zh: '[PRE48]'
- en: 'To set the `JAVA_HOME` environment variable, first get the Java installation
    location. Do this by executing the following command:'
  id: totrans-204
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要设置`JAVA_HOME`环境变量，请首先获取 Java 安装位置。通过执行以下命令来执行此操作：
- en: '[PRE49]'
  id: totrans-205
  prefs: []
  type: TYPE_PRE
  zh: '[PRE49]'
- en: 'The previous command will print the list of Java applications installed on
    your machine along with their installation paths. Copy the Java path that appears
    on your Terminal:'
  id: totrans-206
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 上一个命令将打印出安装在您机器上的 Java 应用程序列表，以及它们的安装路径。复制出现在您的终端上的 Java 路径：
- en: '[PRE50]'
  id: totrans-207
  prefs: []
  type: TYPE_PRE
  zh: '[PRE50]'
- en: 'Open the `/etc/environment` file for editing using the following command:'
  id: totrans-208
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令打开`/etc/environment`文件进行编辑：
- en: '[PRE51]'
  id: totrans-209
  prefs: []
  type: TYPE_PRE
  zh: '[PRE51]'
- en: 'Add the Java path (the one that you copied earlier) inside the `/etc/environment` file in
    the following format:'
  id: totrans-210
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 Java 路径（您之前复制的路径）以以下格式添加到`/etc/environment`文件中：
- en: '[PRE52]'
  id: totrans-211
  prefs: []
  type: TYPE_PRE
  zh: '[PRE52]'
- en: Type *Ctrl* + *X* and choose *Y* to save and close the file.
  id: totrans-212
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 键入 *Ctrl* + *X* 并选择 *Y* 保存并关闭文件。
- en: 'Next, reload the file using the following command:'
  id: totrans-213
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用以下命令重新加载文件：
- en: '[PRE53]'
  id: totrans-214
  prefs: []
  type: TYPE_PRE
  zh: '[PRE53]'
- en: Installing the latest version of Jenkins
  id: totrans-215
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安装 Jenkins 的最新版本
- en: 'To install the latest version of Jenkins, follow these steps in sequence:'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 要安装 Jenkins 的最新版本，请按照以下顺序执行以下步骤：
- en: 'Add the repository key to the system using the following command:'
  id: totrans-217
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令将存储库密钥添加到系统中：
- en: '[PRE54]'
  id: totrans-218
  prefs: []
  type: TYPE_PRE
  zh: '[PRE54]'
- en: 'You should get an output of `OK`. Next, append the Debian package repository
    address using the following command:'
  id: totrans-219
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你应该获得一个`OK`的输出。接下来，使用以下命令添加 Debian 软件包存储库地址：
- en: '[PRE55]'
  id: totrans-220
  prefs: []
  type: TYPE_PRE
  zh: '[PRE55]'
- en: 'Update the package index:'
  id: totrans-221
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 更新软件包索引：
- en: '[PRE56]'
  id: totrans-222
  prefs: []
  type: TYPE_PRE
  zh: '[PRE56]'
- en: 'Now, install Jenkins using the following command:'
  id: totrans-223
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，使用以下命令安装 Jenkins：
- en: '[PRE57]'
  id: totrans-224
  prefs: []
  type: TYPE_PRE
  zh: '[PRE57]'
- en: See the *Starting, stopping, and restarting Jenkins on Ubuntu *section if you
    are required to start Jenkins.
  id: totrans-225
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果需要启动 Jenkins，请参阅 *在 Ubuntu 上启动、停止和重新启动 Jenkins* 部分。
- en: Jenkins is now ready for use. By default, the Jenkins service runs on port `8080`.
    To access Jenkins, use `http://localhost:8080/` or `http://<Jenkins server IP
    address>:8080/` in a browser .
  id: totrans-226
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Jenkins 现在已经准备好使用了。默认情况下，Jenkins 服务在端口 `8080` 上运行。要访问 Jenkins，请在浏览器中使用 `http://localhost:8080/`
    或 `http://<Jenkins 服务器 IP 地址>:8080/`。
- en: Installing the latest stable version of Jenkins
  id: totrans-227
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安装最新稳定版本的 Jenkins
- en: 'If you prefer to install a stable version of Jenkins, then follow these step
    in sequence:'
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您希望安装 Jenkins 的稳定版本，请按顺序执行以下步骤：
- en: 'Add the repository key to the system using the following command:'
  id: totrans-229
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令将存储库密钥添加到系统中：
- en: '[PRE58]'
  id: totrans-230
  prefs: []
  type: TYPE_PRE
  zh: '[PRE58]'
- en: 'You should get an output of `OK`. Next, append the Debian package repository
    address using the following command:'
  id: totrans-231
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您应该得到一个 `OK` 的输出。接下来，使用以下命令附加 Debian 软件包存储库地址：
- en: '[PRE59]'
  id: totrans-232
  prefs: []
  type: TYPE_PRE
  zh: '[PRE59]'
- en: 'Update the package index:'
  id: totrans-233
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 更新软件包索引：
- en: '[PRE60]'
  id: totrans-234
  prefs: []
  type: TYPE_PRE
  zh: '[PRE60]'
- en: 'Now, install Jenkins using the following command:'
  id: totrans-235
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，使用以下命令安装 Jenkins：
- en: '[PRE61]'
  id: totrans-236
  prefs: []
  type: TYPE_PRE
  zh: '[PRE61]'
- en: See the *Starting, stopping, and restarting Jenkins on Ubuntu *section if you
    are required to start Jenkins.
  id: totrans-237
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果需要启动 Jenkins，请参阅 *在 Ubuntu 上启动、停止和重新启动 Jenkins* 部分。
- en: Jenkins is now ready for use. By default, the Jenkins service runs on port `8080`.
    To access Jenkins, use  `http://localhost:8080/` or `http://<Jenkins server IP
    address>:8080/` in a browser.
  id: totrans-238
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Jenkins 现在已经准备好使用了。默认情况下，Jenkins 服务在端口 `8080` 上运行。要访问 Jenkins，请在浏览器中使用 `http://localhost:8080/`
    或 `http://<Jenkins 服务器 IP 地址>:8080/`。
- en: In order to troubleshoot Jenkins, access the logs file `/var/log/jenkins/jenkins.log`.
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 为了排除 Jenkins 故障，访问日志文件 `/var/log/jenkins/jenkins.log`。
- en: The Jenkins service runs under the user `Jenkins`*,* which is automatically
    created upon installation.
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: Jenkins 服务以用户 `Jenkins` 运行，该用户在安装时自动创建。
- en: Starting, stopping, and restarting Jenkins on Ubuntu
  id: totrans-241
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在 Ubuntu 上启动、停止和重新启动 Jenkins
- en: 'Jenkins by default starts running when installed. Here are the commands to
    start, stop, restart, and check the status of the Jenkins service:'
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: Jenkins 默认在安装时开始运行。以下是启动、停止、重新启动和检查 Jenkins 服务状态的命令：
- en: 'To start Jenkins, use the following command:'
  id: totrans-243
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要启动 Jenkins，请使用以下命令：
- en: '[PRE62]'
  id: totrans-244
  prefs: []
  type: TYPE_PRE
  zh: '[PRE62]'
- en: 'Similarly, to stop Jenkins, use the following command:'
  id: totrans-245
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 类似地，要停止 Jenkins，请使用以下命令：
- en: '[PRE63]'
  id: totrans-246
  prefs: []
  type: TYPE_PRE
  zh: '[PRE63]'
- en: 'To restart Jenkins, use the following command:'
  id: totrans-247
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要重新启动 Jenkins，请使用以下命令：
- en: '[PRE64]'
  id: totrans-248
  prefs: []
  type: TYPE_PRE
  zh: '[PRE64]'
- en: 'To check the status of the Jenkins service, use the following `systemctl` command:'
  id: totrans-249
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要检查 Jenkins 服务的状态，请使用以下 `systemctl` 命令：
- en: '[PRE65]'
  id: totrans-250
  prefs: []
  type: TYPE_PRE
  zh: '[PRE65]'
- en: 'You should see the following output:'
  id: totrans-251
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您应该看到以下输出：
- en: '[PRE66]'
  id: totrans-252
  prefs: []
  type: TYPE_PRE
  zh: '[PRE66]'
- en: Installing a standalone Jenkins server on Red Hat Linux
  id: totrans-253
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在 Red Hat Linux 上安装独立的 Jenkins 服务器
- en: In this section, we will learn to install Jenkins on Red Hat Linux. The installation
    process discussed here are also applies to Fedora.
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将学习在 Red Hat Linux 上安装 Jenkins。这里讨论的安装过程也适用于 Fedora。
- en: Prerequisites
  id: totrans-255
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 先决条件
- en: 'Before we begin, make sure you have the following things ready:'
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: 在开始之前，请确保您准备好以下事项：
- en: We need a machine with at least 4 GB of RAM and a Multi-core processor.
  id: totrans-257
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们需要一台至少拥有 4 GB RAM 和多核处理器的机器。
- en: Depending on how you manage the infrastructure in your team, the machine could
    be an instance on a cloud platform (such as AWS, DigitalOcean, or any other cloud
    platform), a bare metal machine, or it could be a VM (on VMware vSphere or any
    other server virtualization software).
  id: totrans-258
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 根据您团队中如何管理基础架构，该机器可能是云平台的实例（例如 AWS、DigitalOcean 或任何其他云平台）、裸机、也可能是 VM（在 VMware
    vSphere 或任何其他服务器虚拟化软件上）。
- en: The machine should have RHEL 7.3 installed on it.
  id: totrans-259
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 机器应该安装了 RHEL 7.3。
- en: Check for admin privileges; the installation might ask for an admin username
    and password.
  id: totrans-260
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检查管理员权限；安装可能会要求输入管理员用户名和密码。
- en: Make sure port `8080` is open.
  id: totrans-261
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确保端口 `8080` 是开放的。
- en: Installing Java
  id: totrans-262
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安装 Java
- en: 'Follow these steps to install Java:'
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下步骤安装 Java：
- en: 'Move to the `/tmp` directory and download Java:'
  id: totrans-264
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 移动到 `/tmp` 目录并下载 Java：
- en: '[PRE67]'
  id: totrans-265
  prefs: []
  type: TYPE_PRE
  zh: '[PRE67]'
- en: 'Next, install Java. The following command will install the JRE:'
  id: totrans-266
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，安装 Java。以下命令将安装 JRE：
- en: '[PRE68]'
  id: totrans-267
  prefs: []
  type: TYPE_PRE
  zh: '[PRE68]'
- en: 'To set the `JAVA_HOME` environment variable, first get the Java installation''s
    location. Do this by executing the following command:'
  id: totrans-268
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要设置 `JAVA_HOME` 环境变量，请首先获取 Java 安装位置。通过执行以下命令来执行此操作：
- en: '[PRE69]'
  id: totrans-269
  prefs: []
  type: TYPE_PRE
  zh: '[PRE69]'
- en: 'The previous command will print the list of Java applications installed on
    your machine, along with their installation paths. Copy the Java path that appears
    on your Terminal:'
  id: totrans-270
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 上一个命令将打印出在您的机器上安装的 Java 应用程序列表，以及它们的安装路径。复制在您的终端上出现的 Java 路径：
- en: '[PRE70]'
  id: totrans-271
  prefs: []
  type: TYPE_PRE
  zh: '[PRE70]'
- en: 'Add the Java path (the one that you copied earlier) inside the `/etc/environment` file using
    the following command:'
  id: totrans-272
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令将 Java 路径（先前复制的路径）添加到 `/etc/environment` 文件内：
- en: '[PRE71]'
  id: totrans-273
  prefs: []
  type: TYPE_PRE
  zh: '[PRE71]'
- en: Installing the latest version of Jenkins
  id: totrans-274
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安装最新版本的 Jenkins
- en: 'To install the latest version of Jenkins, follow these steps:'
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: 要安装最新版本的 Jenkins，请按照以下步骤进行：
- en: 'Add the Jenkins repository to the `yum` repository using the following command:'
  id: totrans-276
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令将 Jenkins 仓库添加到 `yum` 仓库内：
- en: '[PRE72]'
  id: totrans-277
  prefs: []
  type: TYPE_PRE
  zh: '[PRE72]'
- en: 'Install Jenkins using the following command:'
  id: totrans-278
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令安装 Jenkins：
- en: '[PRE73]'
  id: totrans-279
  prefs: []
  type: TYPE_PRE
  zh: '[PRE73]'
- en: See the *Starting, stopping, and restarting Jenkins on Red Hat Linux* section if
    you are required to start Jenkins.
  id: totrans-280
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果需要启动 Jenkins，请查看 *在 Red Hat Linux 上启动、停止和重启 Jenkins* 部分。
- en: Jenkins is now ready for use. By default, the Jenkins service runs on port `8080`.
    To access Jenkins, use  `http://localhost:8080/` or `http://<Jenkins server IP
    address>:8080/` in a browser.
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: Jenkins 现在已准备就绪。默认情况下，Jenkins 服务运行在端口 `8080` 上。要访问 Jenkins，请在浏览器中使用  `http://localhost:8080/`
    或 `http://<Jenkins 服务器 IP 地址>:8080/` 。
- en: Installing the latest stable version of Jenkins
  id: totrans-282
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安装最新稳定版本的 Jenkins
- en: 'If you prefer to install a stable version of Jenkins, then follow these steps:'
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您更喜欢安装 Jenkins 的稳定版本，请按照以下步骤操作：
- en: 'Add the Jenkins repository to the `yum` repository using the following command:'
  id: totrans-284
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令将 Jenkins 仓库添加到 `yum` 仓库内：
- en: '[PRE74]'
  id: totrans-285
  prefs: []
  type: TYPE_PRE
  zh: '[PRE74]'
- en: 'Install Jenkins using the following command:'
  id: totrans-286
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令安装 Jenkins：
- en: '[PRE75]'
  id: totrans-287
  prefs: []
  type: TYPE_PRE
  zh: '[PRE75]'
- en: See the *Starting, stopping, and restarting Jenkins on Red Hat Linux* section
    if you are required to start Jenkins.
  id: totrans-288
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果需要启动 Jenkins，请查看 *在 Red Hat Linux 上启动、停止和重启 Jenkins* 部分。
- en: Starting, stopping, and restarting Jenkins on Red Hat Linux
  id: totrans-289
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在 Red Hat Linux 上启动、停止和重启 Jenkins
- en: 'Here are the commands to start, stop, restart, and check the status of the
    Jenkins service:'
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: 这些是启动、停止、重启和检查 Jenkins 服务状态的命令：
- en: 'To start Jenkins, use the following command:'
  id: totrans-291
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要启动 Jenkins，请使用以下命令：
- en: '[PRE76]'
  id: totrans-292
  prefs: []
  type: TYPE_PRE
  zh: '[PRE76]'
- en: 'Similarly, to stop Jenkins, use the following command:'
  id: totrans-293
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 同样，要停止 Jenkins，请使用以下命令：
- en: '[PRE77]'
  id: totrans-294
  prefs: []
  type: TYPE_PRE
  zh: '[PRE77]'
- en: 'To restart Jenkins, use the following command:'
  id: totrans-295
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要重启 Jenkins，请使用以下命令：
- en: '[PRE78]'
  id: totrans-296
  prefs: []
  type: TYPE_PRE
  zh: '[PRE78]'
- en: 'To check the status of the Jenkins service, use the following `systemctl` command:'
  id: totrans-297
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要检查 Jenkins 服务的状态，请使用以下 `systemctl` 命令：
- en: '[PRE79]'
  id: totrans-298
  prefs: []
  type: TYPE_PRE
  zh: '[PRE79]'
- en: 'You should see the following output:'
  id: totrans-299
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您应该看到以下输出：
- en: '[PRE80]'
  id: totrans-300
  prefs: []
  type: TYPE_PRE
  zh: '[PRE80]'
- en: In order to troubleshoot Jenkins, access the logs in `var/log/jenkins/jenkins.log`.
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: 为了排除 Jenkins 问题，请访问 `var/log/jenkins/jenkins.log` 中的日志。
- en: The Jenkins service runs with the user Jenkins, which automatically gets created
    upon installation.
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: Jenkins 服务以 Jenkins 用户运行，该用户会在安装时自动创建。
- en: Running Jenkins behind a reverse proxy
  id: totrans-303
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在反向代理后运行 Jenkins
- en: In this example, we will learn how to position an Nginx server (running on a
    standalone machine) front of a Jenkins server (running on another standalone machine).
  id: totrans-304
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个例子中，我们将学习如何将一个 Nginx 服务器（在一个独立的机器上运行）放置在 Jenkins 服务器（在另一个独立的机器上运行）的前面。
- en: Prerequisites
  id: totrans-305
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 先决条件
- en: 'Before we begin, make sure you have the following things ready:'
  id: totrans-306
  prefs: []
  type: TYPE_NORMAL
  zh: 在开始之前，请确保您已准备好以下事项：
- en: We need two machines with at least 4 GB of RAM and a Multi-core processor. One
    will run Nginx and the other will run Jenkins.
  id: totrans-307
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们需要两台至少配备 4GB 内存和多核处理器的机器。一台将运行 Nginx，另一台将运行 Jenkins。
- en: Depending on how you manage the infrastructure in your team, the machine could
    be an instance on a cloud platform (such as AWS, DigitalOcean, or any other cloud
    platform), a bare metal machine, or it could be a VM (on VMware vSphere or any
    other server virtualization software).
  id: totrans-308
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 根据团队如何管理基础设施，该机器可以是云平台上的实例（例如 AWS、DigitalOcean 或任何其他云平台）、裸机服务器，或者它可以是一个 VM（在
    VMware vSphere 或任何其他服务器虚拟化软件上）。
- en: The machine should have Ubuntu 16.04 or greater installed on it.
  id: totrans-309
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 机器应该安装了 Ubuntu 16.04 或更高版本。
- en: Check for admin privileges; the installation might ask for an admin username
    and password.
  id: totrans-310
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检查管理员权限；安装可能会要求管理员用户名和密码。
- en: Both machines should be on the same network. The following setup assumes that
    your organization has an intranet for all its services.
  id: totrans-311
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 两台机器应该在同一个网络上。以下设置假设您的组织有一个用于所有服务的内部网络。
- en: Installing and configuring Nginx
  id: totrans-312
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安装和配置 Nginx
- en: 'The installation of Nginx on Ubuntu is simple. Follow these steps to install
    an Nginx server on Ubuntu:'
  id: totrans-313
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Ubuntu 上安装 Nginx 很简单。请按照以下步骤在 Ubuntu 上安装 Nginx 服务器：
- en: 'Update the local package index:'
  id: totrans-314
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 更新本地软件包索引：
- en: '[PRE81]'
  id: totrans-315
  prefs: []
  type: TYPE_PRE
  zh: '[PRE81]'
- en: 'Install `nginx` using the following command:'
  id: totrans-316
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令安装 `nginx`：
- en: '[PRE82]'
  id: totrans-317
  prefs: []
  type: TYPE_PRE
  zh: '[PRE82]'
- en: Configuring the firewall on a Nginx server
  id: totrans-318
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 配置 Nginx 服务器的防火墙
- en: 'We need to configure the firewall on our Nginx server to allow access to the
    Nginx service. Follow these steps:'
  id: totrans-319
  prefs: []
  type: TYPE_NORMAL
  zh: 我们需要在我们的 Nginx 服务器上配置防火墙以允许访问 Nginx 服务。请按照以下步骤操作：
- en: 'Check the firewall status using the `ufw` command:'
  id: totrans-320
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 `ufw` 命令检查防火墙状态：
- en: '[PRE83]'
  id: totrans-321
  prefs: []
  type: TYPE_PRE
  zh: '[PRE83]'
- en: 'You should see the following output:'
  id: totrans-322
  prefs: []
  type: TYPE_NORMAL
  zh: 应该看到以下输出：
- en: '[PRE84]'
  id: totrans-323
  prefs: []
  type: TYPE_PRE
  zh: '[PRE84]'
- en: 'If it''s enabled, move to *step 3*. But, if you find it disabled, then enable
    the firewall using the following command:'
  id: totrans-324
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果已启用，请转到 *第三步*。但是，如果发现它被禁用了，则使用以下命令启用防火墙：
- en: '[PRE85]'
  id: totrans-325
  prefs: []
  type: TYPE_PRE
  zh: '[PRE85]'
- en: You should see the following output
  id: totrans-326
  prefs: []
  type: TYPE_NORMAL
  zh: 应该看到以下输出
- en: '[PRE86]'
  id: totrans-327
  prefs: []
  type: TYPE_PRE
  zh: '[PRE86]'
- en: 'List the available configurations using the following command. You should see
    three Nginx profiles and one OpenSSH profile:'
  id: totrans-328
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令列出可用的配置。你应该看到三个 Nginx 配置文件和一个 OpenSSH 配置文件：
- en: '[PRE87]'
  id: totrans-329
  prefs: []
  type: TYPE_PRE
  zh: '[PRE87]'
- en: You should see the following output
  id: totrans-330
  prefs: []
  type: TYPE_NORMAL
  zh: 应该看到以下输出
- en: '[PRE88]'
  id: totrans-331
  prefs: []
  type: TYPE_PRE
  zh: '[PRE88]'
- en: The `Nginx Full` profile opens port `80` (unencrypted) and port `443` (TLS/SSL).
  id: totrans-332
  prefs: []
  type: TYPE_NORMAL
  zh: '`Nginx Full` 配置文件打开 `80` 端口（未加密）和 `443` 端口（TLS/SSL）。'
- en: The `Nginx HTTP` profile opens only port `80` (unencrypted).
  id: totrans-333
  prefs: []
  type: TYPE_NORMAL
  zh: '`Nginx HTTP` 配置文件仅打开 `80` 端口（未加密）。'
- en: The `Nginx HTTPS` profile opens only port `443` (TLS/SSL).
  id: totrans-334
  prefs: []
  type: TYPE_NORMAL
  zh: '`Nginx HTTPS` 配置文件仅打开 `443` 端口（TLS/SSL）。'
- en: The `OpenSSH` profile opens only port `22` (SSH).
  id: totrans-335
  prefs: []
  type: TYPE_NORMAL
  zh: '`OpenSSH` 配置文件仅打开 `22` 端口（SSH）。'
- en: It is always recommended to enable the most restrictive profile.
  id: totrans-336
  prefs: []
  type: TYPE_NORMAL
  zh: 始终建议启用最严格的配置文件。
- en: 'To keep things simple, we will enable the `Nginx Full` profile, as shown in
    the following command:'
  id: totrans-337
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为了保持简单，我们将启用 `Nginx Full` 配置文件，如以下命令所示：
- en: '[PRE89]'
  id: totrans-338
  prefs: []
  type: TYPE_PRE
  zh: '[PRE89]'
- en: 'Also, enable the `OpenSSH` profile if it''s not active, as shown. This will
    allow us to continue accessing our Nginx machine over SSH:'
  id: totrans-339
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果未激活，则启用 `OpenSSH` 配置文件，如所示。这将允许我们继续通过 SSH 访问我们的 Nginx 机器：
- en: '[PRE90]'
  id: totrans-340
  prefs: []
  type: TYPE_PRE
  zh: '[PRE90]'
- en: You won't be able to log in to your Nginx machine if OpenSSH is disabled.
  id: totrans-341
  prefs: []
  type: TYPE_NORMAL
  zh: 如果 OpenSSH 被禁用，你将无法登录到你的 Nginx 机器。
- en: 'Verify the changes using the following command. You should see `Nginx Full`
    and `OpenSSH` as allowed:'
  id: totrans-342
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令验证更改。你应该看到 `Nginx Full` 和 `OpenSSH` 被允许：
- en: '[PRE91]'
  id: totrans-343
  prefs: []
  type: TYPE_PRE
  zh: '[PRE91]'
- en: 'You should see the following output:'
  id: totrans-344
  prefs: []
  type: TYPE_NORMAL
  zh: 应该看到以下输出：
- en: '[PRE92]'
  id: totrans-345
  prefs: []
  type: TYPE_PRE
  zh: '[PRE92]'
- en: 'Check if the Nginx service is running using the `systemctl` command:'
  id: totrans-346
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 `systemctl` 命令检查 Nginx 服务是否正在运行：
- en: '[PRE93]'
  id: totrans-347
  prefs: []
  type: TYPE_PRE
  zh: '[PRE93]'
- en: 'You should see the following output:'
  id: totrans-348
  prefs: []
  type: TYPE_NORMAL
  zh: 应该看到以下输出：
- en: '[PRE94]'
  id: totrans-349
  prefs: []
  type: TYPE_PRE
  zh: '[PRE94]'
- en: 'From the previous output, you can see that our Nginx service is running fine.
    Now try to access it using the browser. First, get the IP address of your machine
    using the `ip route` command:'
  id: totrans-350
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从前面的输出中，你可以看到我们的 Nginx 服务正常运行。现在尝试使用浏览器访问它。首先，使用 `ip route` 命令获取你的机器的 IP 地址：
- en: '[PRE95]'
  id: totrans-351
  prefs: []
  type: TYPE_PRE
  zh: '[PRE95]'
- en: 'You should see the following output:'
  id: totrans-352
  prefs: []
  type: TYPE_NORMAL
  zh: 应该看到以下输出：
- en: '[PRE96]'
  id: totrans-353
  prefs: []
  type: TYPE_PRE
  zh: '[PRE96]'
- en: 'Now access the Nginx home page using `http://<IP Address>:80`. You should see
    something similar to the following screenshot:'
  id: totrans-354
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在使用 `http://<IP Address>:80` 访问 Nginx 主页。你应该看到类似以下截图的内容：
- en: '![](img/475542b9-94b7-47d6-a833-8837d27d1f70.png)'
  id: totrans-355
  prefs: []
  type: TYPE_IMG
  zh: '![](img/475542b9-94b7-47d6-a833-8837d27d1f70.png)'
- en: The Nginx index page
  id: totrans-356
  prefs: []
  type: TYPE_NORMAL
  zh: Nginx 索引页面
- en: Starting, stopping, and restarting the Nginx server
  id: totrans-357
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 启动、停止和重新启动 Nginx 服务器
- en: 'Now that we have your Nginx server up, let''s see some commands we can use
    to manage Nginx. Just like Jenkins, we will use the `systemctl` command to manage
    Nginx:'
  id: totrans-358
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们的 Nginx 服务器已经启动了，让我们看看一些可以用来管理 Nginx 的命令。就像 Jenkins 一样，我们将使用 `systemctl`
    命令来管理 Nginx：
- en: 'To stop Nginx, use the following command:'
  id: totrans-359
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要停止 Nginx，请使用以下命令：
- en: '[PRE97]'
  id: totrans-360
  prefs: []
  type: TYPE_PRE
  zh: '[PRE97]'
- en: 'To start Nginx when it is stopped, use the following command:'
  id: totrans-361
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要在停止时启动 Nginx，请使用以下命令：
- en: '[PRE98]'
  id: totrans-362
  prefs: []
  type: TYPE_PRE
  zh: '[PRE98]'
- en: 'To restart Nginx, use the following command:'
  id: totrans-363
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要重新启动 Nginx，请使用以下命令：
- en: '[PRE99]'
  id: totrans-364
  prefs: []
  type: TYPE_PRE
  zh: '[PRE99]'
- en: 'To reload Nginx after making configuration changes, use the following command:'
  id: totrans-365
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 若要在进行配置更改后重新加载 Nginx，请使用以下命令：
- en: '[PRE100]'
  id: totrans-366
  prefs: []
  type: TYPE_PRE
  zh: '[PRE100]'
- en: Securing Nginx using OpenSSL
  id: totrans-367
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 OpenSSL 保护 Nginx
- en: In this section, we will learn to set up a self-signed SSL certificate for use
    with our Nginx server.
  id: totrans-368
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将学习为我们的 Nginx 服务器设置自签名 SSL 证书。
- en: Creating an SSL certificate
  id: totrans-369
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建 SSL 证书
- en: 'Run the following command to create a self-signed key and a certificate pair
    using OpenSSL:'
  id: totrans-370
  prefs: []
  type: TYPE_NORMAL
  zh: 运行以下命令使用 OpenSSL 创建自签名密钥和证书对：
- en: '[PRE101]'
  id: totrans-371
  prefs: []
  type: TYPE_PRE
  zh: '[PRE101]'
- en: 'The following table explains the arguments used in the previous command:'
  id: totrans-372
  prefs: []
  type: TYPE_NORMAL
  zh: 以下表格解释了前面命令中使用的参数：
- en: '| **Parameters** | **Description** |'
  id: totrans-373
  prefs: []
  type: TYPE_TB
  zh: '| **参数** | **描述** |'
- en: '| `req` | This argument indicates that we want to use X.509 **Certificate Signing
    Request** (**CSR**) management. |'
  id: totrans-374
  prefs: []
  type: TYPE_TB
  zh: '| `req` | 此参数指示我们要使用 X.509 **证书签名请求** (**CSR**) 管理。 |'
- en: '| `-x509` | This argument allows us to create a self-signed certificate instead
    of generating a certificate signing request. |'
  id: totrans-375
  prefs: []
  type: TYPE_TB
  zh: '| `-x509` | 此参数允许我们创建自签名证书而不是生成证书签名请求。 |'
- en: '| `-nodes` | This argument allows OpenSSL to skip the option to authenticate
    our certificate with a passphrase. |'
  id: totrans-376
  prefs: []
  type: TYPE_TB
  zh: '| `-nodes` | 此参数允许 OpenSSL 跳过使用密码短语验证我们的证书的选项。 |'
- en: '| `-days` | This argument sets the duration for which the certificate is valid.
    |'
  id: totrans-377
  prefs: []
  type: TYPE_TB
  zh: '| `-days` | 此参数设置证书有效期。 |'
- en: '| `-newkey rsa: 2048` | This argument tells OpenSSL to generate a new certificate
    and a new key at the same time. The `rsa:2048` option makes the RSA key `2048`
    bits long. |'
  id: totrans-378
  prefs: []
  type: TYPE_TB
  zh: '| `-newkey rsa: 2048` | 此参数告诉OpenSSL同时生成新证书和新密钥。 `rsa:2048` 选项使RSA密钥长度为 `2048`
    位。 |'
- en: '| `-keyout` | This argument allows you to store the generated private key file
    in the location of your choice. |'
  id: totrans-379
  prefs: []
  type: TYPE_TB
  zh: '| `-keyout` | 此参数允许您将生成的私钥文件存储在您选择的位置。 |'
- en: '| `-out` | This argument allows you to store the generated certificates in
    the location of your choice. |'
  id: totrans-380
  prefs: []
  type: TYPE_TB
  zh: '| `-out` | 此参数允许你将生成的证书存储在你选择的位置。 |'
- en: 'The moment you issue the following command to generate a private key and new
    certificate, you will be prompted to provide information. The prompts will look
    something as shown here:'
  id: totrans-381
  prefs: []
  type: TYPE_NORMAL
  zh: 当你执行以下命令生成一个新的私钥和证书时，将提示你提供信息。 提示将如下所示：
- en: '[PRE102]'
  id: totrans-382
  prefs: []
  type: TYPE_PRE
  zh: '[PRE102]'
- en: The **Common Name** (**CN**) field, also known as the **Fully Qualified Domain
    Name** (**FQDN**) is very important. You need to provide the IP address or the
    domain name of your Nginx server.
  id: totrans-383
  prefs: []
  type: TYPE_NORMAL
  zh: '**通用名称**（**CN**）字段，也称为**完全限定域名**（**FQDN**）非常重要。 你需要提供你的Nginx服务器的IP地址或域名。'
- en: The `/etc/ssl/private/` will now contain your `nginx-selfsigned.key` file and
    the `/etc/ssl/certs/` will contain your `nginx-selfsigned.crt` file.
  id: totrans-384
  prefs: []
  type: TYPE_NORMAL
  zh: '`/etc/ssl/private/` 现在将包含你的 `nginx-selfsigned.key` 文件，而 `/etc/ssl/certs/` 将包含你的
    `nginx-selfsigned.crt` 文件。'
- en: 'Next, we will create a strong Diffie-Hellman group, which is used in negotiating
    **Perfect Forward Secrecy** (**PFS**) with clients. We will do this by using `openssl`,
    as shown in the following command:'
  id: totrans-385
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将创建一个强大的Diffie-Hellman组，用于与客户端协商**完全前向安全**（**PFS**）。我们将通过使用`openssl`来执行以下命令：
- en: '[PRE103]'
  id: totrans-386
  prefs: []
  type: TYPE_PRE
  zh: '[PRE103]'
- en: This will take quite some time, but once it's done it will generate a `dhparam.pem`
    file inside `/etc/ssl/certs/`.
  id: totrans-387
  prefs: []
  type: TYPE_NORMAL
  zh: 这将需要相当长的时间，但完成后，它将在 `/etc/ssl/certs/` 内生成一个 `dhparam.pem` 文件。
- en: Creating strong encryption settings
  id: totrans-388
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建强加密设置
- en: 'In the following section, we will set up a strong SSL cipher suite to secure
    our Nginx server:'
  id: totrans-389
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一节中，我们将设置一个强大的SSL密码套件来保护我们的Nginx服务器：
- en: 'Create a configuration file named `*s*sl-params.conf` in `/etc/nginx/snippets/`
    as shown here:'
  id: totrans-390
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为 `*s*sl-params.conf` 的配置文件在`/etc/nginx/snippets/`中，如下所示：
- en: '[PRE104]'
  id: totrans-391
  prefs: []
  type: TYPE_PRE
  zh: '[PRE104]'
- en: 'Copy the following code inside the file:'
  id: totrans-392
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将以下代码复制到文件中：
- en: '[PRE105]'
  id: totrans-393
  prefs: []
  type: TYPE_PRE
  zh: '[PRE105]'
- en: Type *Ctrl* + *X* and choose *Y* to save and close the file.
  id: totrans-394
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入 *Ctrl* + *X*，选择 *Y* 保存并关闭文件。
- en: We have used the recommendations by Remy van Elst that are available at [https://cipherli.st/](https://cipherli.st/).
  id: totrans-395
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用了Remy van Elst在 [https://cipherli.st/](https://cipherli.st/) 中提供的建议。
- en: Modifying the Nginx configuration
  id: totrans-396
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 修改Nginx配置
- en: 'Next, we will modify our Nginx configuration to enable SSL. Follow these steps:'
  id: totrans-397
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将修改我们的Nginx配置以启用SSL。 按照以下步骤进行：
- en: 'First and foremost, take a backup of your existing Nginx configuration file
    named `default` that is in `/etc/nginx/sites-available/`:'
  id: totrans-398
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，备份你现有的位于`/etc/nginx/sites-available/`中名为`default`的Nginx配置文件：
- en: '[PRE106]'
  id: totrans-399
  prefs: []
  type: TYPE_PRE
  zh: '[PRE106]'
- en: 'Now, open the file for editing using the following command:'
  id: totrans-400
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，使用以下命令打开文件进行编辑：
- en: '[PRE107]'
  id: totrans-401
  prefs: []
  type: TYPE_PRE
  zh: '[PRE107]'
- en: 'You will find a lot of commented lines inside the file. If you ignore them
    for a while, you will probably see the following:'
  id: totrans-402
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你会在文件中找到很多被注释掉的内容。 如果你暂时忽略它们，你可能会看到以下内容：
- en: '[PRE108]'
  id: totrans-403
  prefs: []
  type: TYPE_PRE
  zh: '[PRE108]'
- en: 'We will modify the configuration so that the unencrypted HTTP requests are
    automatically redirected to encrypted HTTPS. We will do this by adding the following
    three lines, as highlighted in the following code:'
  id: totrans-404
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们将修改配置以便未加密的HTTP请求自动重定向到加密的HTTPS。 我们将通过添加以下三行来执行此操作，如下方代码中所示：
- en: '[PRE109]'
  id: totrans-405
  prefs: []
  type: TYPE_PRE
  zh: '[PRE109]'
- en: From the previous code, you can see that we have closed the server block.
  id: totrans-406
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从前面的代码中，你可以看到我们已关闭了服务器块。
- en: 'Next, we will start a new server block, uncomment the two `listen` directives
    that use port `443`, and add `http2` to these lines in order to enable HTTP/2,
    as shown in the following code block:'
  id: totrans-407
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们将启动一个新的服务器块，取消注释使用端口`443`的两个`listen`指令，并在这些行中添加`http2`以启用HTTP/2，如下代码块所示：
- en: '[PRE110]'
  id: totrans-408
  prefs: []
  type: TYPE_PRE
  zh: '[PRE110]'
- en: 'Next, we will add the location of our self-signed certificate and key. We just
    need to include the two snippet files we set up:'
  id: totrans-409
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们将添加我们自签名证书和密钥的位置。 我们只需要包含我们设置的两个片段文件：
- en: '[PRE111]'
  id: totrans-410
  prefs: []
  type: TYPE_PRE
  zh: '[PRE111]'
- en: 'Next, we will set the `server_name` value to our Nginx IP or domain name inside
    our SSL server block. By default, the `server_name` may be set to an *underscore*
    (`_`)*,* as shown in the following code block:'
  id: totrans-411
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们将在SSL服务器块内设置`server_name`值为我们的Nginx IP或域名。默认情况下，`server_name` 可能被设置为一个下划线(`_`)*,*
    如下代码块所示：
- en: '[PRE112]'
  id: totrans-412
  prefs: []
  type: TYPE_PRE
  zh: '[PRE112]'
- en: Type *Ctrl* + *X* and choose *Y* to save and close the file.
  id: totrans-413
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入 *Ctrl* + *X*，选择 *Y* 保存并关闭文件。
- en: Enabling the changes and testing our Nginx setup
  id: totrans-414
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 启用更改并测试我们的Nginx设置
- en: 'We will now restart Nginx to implement our new changes:'
  id: totrans-415
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们将重新启动Nginx来实施我们的新更改：
- en: 'First, check whether there are any syntax errors in our files. Do this by typing
    the following command:'
  id: totrans-416
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，检查我们的文件中是否有任何语法错误。通过输入以下命令来执行此操作：
- en: '[PRE113]'
  id: totrans-417
  prefs: []
  type: TYPE_PRE
  zh: '[PRE113]'
- en: 'If everything is successful, you should see something similar to the following
    command output:'
  id: totrans-418
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果一切顺利，你应该能够看到类似以下命令输出的内容：
- en: '[PRE114]'
  id: totrans-419
  prefs: []
  type: TYPE_PRE
  zh: '[PRE114]'
- en: 'Restart Nginx using the following command:'
  id: totrans-420
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令重新启动Nginx：
- en: '[PRE115]'
  id: totrans-421
  prefs: []
  type: TYPE_PRE
  zh: '[PRE115]'
- en: Next, access your Nginx server using `http://<Nginx_IP_Address>:80`. You should
    notice that you have been automatically redirected to `https://<Nginx_IP_Address>:80`.
  id: totrans-422
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用`http://<Nginx_IP_Address>:80`访问您的Nginx服务器。您应该注意到您已被自动重定向到`https://<Nginx_IP_Address>:80`。
- en: 'You will see a warning that looks similar to the following screenshot:'
  id: totrans-423
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您将看到类似以下截图的警告：
- en: '![](img/5778110f-0867-4c0c-b119-383604539831.png)'
  id: totrans-424
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5778110f-0867-4c0c-b119-383604539831.png)'
- en: SSL warning
  id: totrans-425
  prefs: []
  type: TYPE_NORMAL
  zh: SSL警告
- en: This is expected, as the certificate that we created isn't signed by one of
    your browser's trusted certificate authorities.
  id: totrans-426
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 这是预期的，因为我们创建的证书未由您浏览器信任的证书颁发机构签名。
- en: 'Click on the Advanced... button and then click on **Proceed to 192.168.56.104
    (unsafe)**:'
  id: totrans-427
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 单击高级按钮，然后单击**继续访问 192.168.56.104（不安全）**：
- en: '![](img/f560e82a-351b-4746-afe3-af784edc9e8b.png)'
  id: totrans-428
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f560e82a-351b-4746-afe3-af784edc9e8b.png)'
- en: Proceeding as unsafe
  id: totrans-429
  prefs: []
  type: TYPE_NORMAL
  zh: 以不安全的方式继续
- en: 'You should now be able to see the Nginx default page, as shown in the following
    screenshot:'
  id: totrans-430
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您现在应该能够看到Nginx默认页面，如以下截图所示：
- en: '![](img/5c249a7f-420a-40f2-ad57-94182360e9f5.png)'
  id: totrans-431
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5c249a7f-420a-40f2-ad57-94182360e9f5.png)'
- en: The Nginx index page with SSL encryption
  id: totrans-432
  prefs: []
  type: TYPE_NORMAL
  zh: 带有SSL加密的Nginx索引页面
- en: Configuring the Jenkins server
  id: totrans-433
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 配置Jenkins服务器
- en: In this section, we will perform some configurations on our Jenkins server.
    To set up a Jenkins server in the first place, see the *Installing a standalone
    Jenkins server on Ubuntu* section.
  id: totrans-434
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将对我们的Jenkins服务器执行一些配置。要首先设置Jenkins服务器，请参阅*在Ubuntu上安装独立的Jenkins服务器*部分。
- en: 'Once you have a Jenkins server up and running, follow these steps:'
  id: totrans-435
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦您运行起一个Jenkins服务器，就按照以下步骤进行操作：
- en: To make Jenkins work with Nginx, we need to update the Jenkins configuration
    so that the Jenkins server listens only on the Jenkins IP address or the Jenkins
    domain name interface rather than all interfaces (`0.0.0.0`). If Jenkins listens
    on all interfaces, then it's potentially accessible on its original, unencrypted
    port (`8080`).
  id: totrans-436
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要使Jenkins与Nginx配合工作，我们需要更新Jenkins配置，以便Jenkins服务器仅侦听Jenkins IP地址或Jenkins域名接口，而不是所有接口（`0.0.0.0`）。如果Jenkins监听所有接口，则可能可以在其原始未加密端口（`8080`）上访问。
- en: 'To achieve this, modify the `/etc/default/jenkins` configuration file, as shown
    in the following command:'
  id: totrans-437
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为此，请修改`/etc/default/jenkins`配置文件，如下所示：
- en: '[PRE116]'
  id: totrans-438
  prefs: []
  type: TYPE_PRE
  zh: '[PRE116]'
- en: Inside the file, scroll all the way down to the last line or just look for the `JENKINS_ARGS`
    line.
  id: totrans-439
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在文件中，滚动到最后一行或者只查找`JENKINS_ARGS`行。
- en: 'Append the following argument to the existing value of `JENKINS_ARGS`:'
  id: totrans-440
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将以下参数追加到现有的`JENKINS_ARGS`值：
- en: '[PRE117]'
  id: totrans-441
  prefs: []
  type: TYPE_PRE
  zh: '[PRE117]'
- en: 'The final `JENKINS_ARGS` line should look something like this (single line):'
  id: totrans-442
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最终的`JENKINS_ARGS`行应该类似于这样（单行）：
- en: '[PRE118]'
  id: totrans-443
  prefs: []
  type: TYPE_PRE
  zh: '[PRE118]'
- en: Type *Ctrl* + *X* and choose *Y* to save and close the file.
  id: totrans-444
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入*Ctrl* + *X*并选择*Y*以保存并关闭文件。
- en: 'To make the new configuration effective, restart the Jenkins server:'
  id: totrans-445
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为了使新的配置生效，重新启动Jenkins服务器：
- en: '[PRE119]'
  id: totrans-446
  prefs: []
  type: TYPE_PRE
  zh: '[PRE119]'
- en: 'To check whether Jenkins is running properly, execute the following command:'
  id: totrans-447
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要检查Jenkins是否正常运行，请执行以下命令：
- en: '[PRE120]'
  id: totrans-448
  prefs: []
  type: TYPE_PRE
  zh: '[PRE120]'
- en: 'You should see the following screenshot:'
  id: totrans-449
  prefs: []
  type: TYPE_NORMAL
  zh: 你应该能够看到以下截图：
- en: '[PRE121]'
  id: totrans-450
  prefs: []
  type: TYPE_PRE
  zh: '[PRE121]'
- en: Adding reverse proxy settings to the Nginx configuration
  id: totrans-451
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 将反向代理设置添加到Nginx配置中
- en: 'The following steps will help you to add reverse proxy settings to the Nginx
    configuration:'
  id: totrans-452
  prefs: []
  type: TYPE_NORMAL
  zh: 以下步骤将帮助您向Nginx配置中添加反向代理设置：
- en: 'Open the Nginx configuration file for editing:'
  id: totrans-453
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开Nginx配置文件进行编辑：
- en: '[PRE122]'
  id: totrans-454
  prefs: []
  type: TYPE_PRE
  zh: '[PRE122]'
- en: 'As we''re sending all requests to our Jenkins server, comment out the default
    `try_files` line, as shown in the following code block:'
  id: totrans-455
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 因为我们将所有请求发送到我们的Jenkins服务器，所以请注释掉默认的`try_files`行，如下面的代码块所示：
- en: '[PRE123]'
  id: totrans-456
  prefs: []
  type: TYPE_PRE
  zh: '[PRE123]'
- en: 'Next, add the proxy settings as shown here:'
  id: totrans-457
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，添加如下所示的代理设置：
- en: '[PRE124]'
  id: totrans-458
  prefs: []
  type: TYPE_PRE
  zh: '[PRE124]'
- en: Type *Ctrl* + *X* and choose *Y* to save and close the file.
  id: totrans-459
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入*Ctrl* + *X*并选择*Y*以保存并关闭文件。
- en: 'Run the following command to check for any syntax errors in the Nginx configuration
    file:'
  id: totrans-460
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行以下命令检查Nginx配置文件中是否存在任何语法错误：
- en: '[PRE125]'
  id: totrans-461
  prefs: []
  type: TYPE_PRE
  zh: '[PRE125]'
- en: 'You should see the following output:'
  id: totrans-462
  prefs: []
  type: TYPE_NORMAL
  zh: 你应该能够看到以下输出：
- en: '[PRE126]'
  id: totrans-463
  prefs: []
  type: TYPE_PRE
  zh: '[PRE126]'
- en: 'If the output is error free, restart Nginx to make the new configuration effective.
    Use the following command:'
  id: totrans-464
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果输出没有错误，请重新启动 Nginx 以使新配置生效。使用以下命令：
- en: '[PRE127]'
  id: totrans-465
  prefs: []
  type: TYPE_PRE
  zh: '[PRE127]'
- en: 'Next, access your Nginx server using `https://<nginx_ip_address>:80`:'
  id: totrans-466
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用`https://<nginx_ip_address>:80`访问您的 Nginx 服务器：
- en: '![](img/e711c177-52a8-4c0a-b7e8-43858a7ab8f6.png)'
  id: totrans-467
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e711c177-52a8-4c0a-b7e8-43858a7ab8f6.png)'
- en: Jenkins getting started page
  id: totrans-468
  prefs: []
  type: TYPE_NORMAL
  zh: Jenkins 入门页面
- en: Running Nginx and Jenkins on the same machine
  id: totrans-469
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在同一台机器上运行 Nginx 和 Jenkins
- en: 'If you want to run Jenkins behind a reverse proxy server (Nginx) with the Jenkins
    server and the Nginx server running on the same machine, then perform the following
    sections in sequence:'
  id: totrans-470
  prefs: []
  type: TYPE_NORMAL
  zh: 如果要在反向代理服务器（Nginx）后运行 Jenkins，且 Jenkins 服务器和 Nginx 服务器在同一台机器上运行，则按顺序执行以下各部分：
- en: Set up a machine with at least 4 GB of RAM and a Multi-core processor.
  id: totrans-471
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用至少 4 GB RAM 和多核处理器设置一台机器。
- en: Depending on how you manage the infrastructure in your team, the machine could
    be an instance on a cloud platform (such as AWS, DigitalOcean, or any other cloud
    platform), or a bare metal machine, or it could be a VM (on VMware vSphere or
    any other server virtualization software).
  id: totrans-472
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 根据团队如何管理基础设施，该机器可能是云平台上的实例（如 AWS、DigitalOcean 或任何其他云平台）、裸机，或者可能是 VM（在 VMware
    vSphere 或任何其他服务器虚拟化软件上）。
- en: The machines should have Ubuntu 16.04 or greater installed on it.
  id: totrans-473
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 机器应安装 Ubuntu 16.04 或更高版本。
- en: Check for admin privileges; the installation might ask for an admin username
    and password.
  id: totrans-474
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 检查管理员权限；安装可能会要求输入管理员用户名和密码。
- en: Install Nginx; refer to the *Installing and configuring Nginx *section.
  id: totrans-475
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 安装 Nginx；参考*安装和配置 Nginx*部分。
- en: Configure the firewall; refer to the *Configuring the firewall on Nginx server *section.
  id: totrans-476
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 配置防火墙；参考*在 Nginx 服务器上配置防火墙*部分。
- en: Secure the Nginx server using OpenSSL; refer to the *Securing Nginx using OpenSSL *section.
  id: totrans-477
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 OpenSSL 安全地配置 Nginx 服务器；参考*使用 OpenSSL 安全地配置 Nginx*部分。
- en: 'Configure the firewall to allow traffic on port `8080` using the following
    command:'
  id: totrans-478
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令配置防火墙以允许端口`8080`上的流量：
- en: '[PRE128]'
  id: totrans-479
  prefs: []
  type: TYPE_PRE
  zh: '[PRE128]'
- en: 'Next, check the firewall status using the following command:'
  id: totrans-480
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用以下命令检查防火墙状态：
- en: '[PRE129]'
  id: totrans-481
  prefs: []
  type: TYPE_PRE
  zh: '[PRE129]'
- en: 'You should see the following output:'
  id: totrans-482
  prefs: []
  type: TYPE_NORMAL
  zh: 您应该看到以下输出：
- en: '[PRE130]'
  id: totrans-483
  prefs: []
  type: TYPE_PRE
  zh: '[PRE130]'
- en: Install Jenkins, refer to the *Installing a standalone Jenkins server on Ubuntu *section.
  id: totrans-484
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 安装 Jenkins，参考*在 Ubuntu 上安装独立 Jenkins 服务器*部分。
- en: Configure the Jenkins server; refer to the *Configuring the Jenkins server *section.
    While performing the steps mentioned in this section, make sure to put `127.0.0.1`
    in place of `<IP Address of your Jenkins>`.
  id: totrans-485
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 配置 Jenkins 服务器；参考*配置 Jenkins 服务器*部分。在执行本节中提到的步骤时，请确保将`<IP Address of your Jenkins>`替换为`127.0.0.1`。
- en: Add the reverse proxy settings in Nginx; refer to the *Adding reverse proxy
    settings to Nginx configuration *section. While performing the steps mentioned
    in this section, you will be asked to enter the Jenkins server IP at various places
    inside the Nginx configuration file. Since our Jenkins server is now running on
    the same machine as Nginx, the value for `<IP Address of your Jenkins>` should
    be `localhost`.
  id: totrans-486
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 Nginx 中添加反向代理设置；参考*将反向代理设置添加到 Nginx 配置*部分。在执行本节中提到的步骤时，您将被要求在 Nginx 配置文件的各处输入
    Jenkins 服务器 IP。由于我们的 Jenkins 服务器现在在与 Nginx 相同的机器上运行，因此`<IP Address of your Jenkins>`的值应为`localhost`。
- en: Running Jenkins on Docker
  id: totrans-487
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在 Docker 上运行 Jenkins
- en: The true advantage of having Jenkins on Docker is when you have to quickly create
    multiple development and staging instances of your production Jenkins server.
    It's also very useful in redirecting the traffic to a secondary Jenkins server
    while you perform maintenance activities on the primary Jenkins server. While
    we will see these use cases later, let's first try to run Jenkins on Docker.
  id: totrans-488
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Docker 上运行 Jenkins 的真正优势在于当您需要快速创建多个开发和分段实例时。它还非常有用，可以在主 Jenkins 服务器上执行维护活动时将流量重定向到次要
    Jenkins 服务器。虽然我们稍后将看到这些用例，但让我们首先尝试在 Docker 上运行 Jenkins。
- en: Prerequisites
  id: totrans-489
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 先决条件
- en: 'Before we begin, make sure you have the following things ready:'
  id: totrans-490
  prefs: []
  type: TYPE_NORMAL
  zh: 在开始之前，请确保准备了以下内容：
- en: We need a machine with at least 4 GB of RAM (the more the better) and a Multi-core
    processor.
  id: totrans-491
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们需要一台至少拥有 4 GB RAM（越多越好）和多核处理器的机器。
- en: Depending on how you manage the infrastructure in your team, the machine could
    be an instance on a cloud platform (such as AWS, DigitalOcean, or any other cloud
    platform), a bare metal machine, or it could be a VM (on VMware vSphere or any
    other server virtualization software).
  id: totrans-492
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 根据团队中的基础设施管理方式，机器可能是云平台上的实例（如 AWS、DigitalOcean 或任何其他云平台）、裸机，或者可能是 VM（在 VMware
    vSphere 或任何其他服务器虚拟化软件上）。
- en: The machines should have Ubuntu 16.04 or greater installed on it.
  id: totrans-493
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 机器应该安装 Ubuntu 16.04 或更高版本。
- en: Check for admin privileges; the installation might ask for an admin username
    and password.
  id: totrans-494
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检查管理员权限；安装可能会要求管理员用户名和密码。
- en: Setting up a Docker host
  id: totrans-495
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 设置 Docker 主机
- en: In this section, we will learn how to install Docker using the repository method
    and using the Debian package. Follow the steps in the following sections to set
    up a Docker host.
  id: totrans-496
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将学习如何使用存储库方法和使用 Debian 软件包安装 Docker。按照以下各节中的步骤设置 Docker 主机。
- en: Setting up the repository
  id: totrans-497
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 设置存储库
- en: 'Follow these steps to set up a repository:'
  id: totrans-498
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下步骤设置存储库：
- en: 'Execute the following command to let `apt` use a repository:'
  id: totrans-499
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令让 `apt` 使用存储库：
- en: '[PRE131]'
  id: totrans-500
  prefs: []
  type: TYPE_PRE
  zh: '[PRE131]'
- en: 'Add Docker''s official GPG key using the following command:'
  id: totrans-501
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令添加 Docker 的官方 GPG 密钥：
- en: '[PRE132]'
  id: totrans-502
  prefs: []
  type: TYPE_PRE
  zh: '[PRE132]'
- en: 'Verify that the key ID is exactly `58118E89F3A912897C070ADBF76221572C52609D` using
    the following command:'
  id: totrans-503
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令验证密钥 ID 是否确实为 `58118E89F3A912897C070ADBF76221572C52609D`：
- en: '[PRE133]'
  id: totrans-504
  prefs: []
  type: TYPE_PRE
  zh: '[PRE133]'
- en: 'You should see the following output:'
  id: totrans-505
  prefs: []
  type: TYPE_NORMAL
  zh: 你应该看到以下输出：
- en: '[PRE134]'
  id: totrans-506
  prefs: []
  type: TYPE_PRE
  zh: '[PRE134]'
- en: 'Use the following command to set up the stable repository to download Docker:'
  id: totrans-507
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令设置稳定存储库以下载 Docker：
- en: '[PRE135]'
  id: totrans-508
  prefs: []
  type: TYPE_PRE
  zh: '[PRE135]'
- en: It's recommended to always use the stable version of repository.
  id: totrans-509
  prefs: []
  type: TYPE_NORMAL
  zh: 建议始终使用稳定版本的存储库。
- en: Installing Docker
  id: totrans-510
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安装 Docker
- en: 'After setting up the repository, perform the following steps to install Docker:'
  id: totrans-511
  prefs: []
  type: TYPE_NORMAL
  zh: 设置存储库后，请执行以下步骤安装 Docker：
- en: 'Update the `apt` package index using the following command:'
  id: totrans-512
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令更新 `apt` 包索引：
- en: '[PRE136]'
  id: totrans-513
  prefs: []
  type: TYPE_PRE
  zh: '[PRE136]'
- en: 'To install the latest version of Docker, run the following command:'
  id: totrans-514
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要安装最新版本的 Docker，请运行以下命令：
- en: '[PRE137]'
  id: totrans-515
  prefs: []
  type: TYPE_PRE
  zh: '[PRE137]'
- en: 'To install a specific version of Docker, list the available versions using
    the following command:'
  id: totrans-516
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要安装特定版本的 Docker，请使用以下命令列出可用版本：
- en: '[PRE138]'
  id: totrans-517
  prefs: []
  type: TYPE_PRE
  zh: '[PRE138]'
- en: 'You should see the following output:'
  id: totrans-518
  prefs: []
  type: TYPE_NORMAL
  zh: 你应该看到以下输出：
- en: '[PRE139]'
  id: totrans-519
  prefs: []
  type: TYPE_PRE
  zh: '[PRE139]'
- en: The output of the previous command depends on the type of repository configured
    in the previous section (*Setting up the repository*).
  id: totrans-520
  prefs: []
  type: TYPE_NORMAL
  zh: 上一个命令的输出取决于前一节中配置的存储库类型（*设置存储库*）。
- en: 'Next, execute the following command to install the specific version of Docker:'
  id: totrans-521
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，执行以下命令来安装特定版本的 Docker：
- en: '[PRE140]'
  id: totrans-522
  prefs: []
  type: TYPE_PRE
  zh: '[PRE140]'
- en: 'The Docker service starts automatically. To verify if Docker is installed and
    running, execute the following command:'
  id: totrans-523
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Docker 服务会自动启动。要验证 Docker 是否已安装并运行，请执行以下命令：
- en: '[PRE141]'
  id: totrans-524
  prefs: []
  type: TYPE_PRE
  zh: '[PRE141]'
- en: 'The previous command should run without any errors, and you should see a `Hello
    from Docker!` message:'
  id: totrans-525
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 前一个命令应该没有错误，并且你应该看到一个 `Hello from Docker!` 的消息：
- en: '[PRE142]'
  id: totrans-526
  prefs: []
  type: TYPE_PRE
  zh: '[PRE142]'
- en: Installing from a package
  id: totrans-527
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 从软件包安装
- en: 'Follow these steps to install Docker using the `.deb` package:'
  id: totrans-528
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下步骤使用 `.deb` 软件包安装 Docker：
- en: Download the `.deb` package of your choice from [https://apt.dockerproject.org/repo/pool/main/d/docker-engine/](https://apt.dockerproject.org/repo/pool/main/d/docker-engine/).
  id: totrans-529
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从 [https://apt.dockerproject.org/repo/pool/main/d/docker-engine/](https://apt.dockerproject.org/repo/pool/main/d/docker-engine/)
    下载你选择的 `.deb` 软件包。
- en: 'To install the downloaded package, execute the following command:'
  id: totrans-530
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要安装已下载的软件包，请执行以下命令：
- en: '[PRE143]'
  id: totrans-531
  prefs: []
  type: TYPE_PRE
  zh: '[PRE143]'
- en: 'Verify your Docker installation by running the following command:'
  id: totrans-532
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行以下命令验证 Docker 安装：
- en: '[PRE144]'
  id: totrans-533
  prefs: []
  type: TYPE_PRE
  zh: '[PRE144]'
- en: 'You should see the following output:'
  id: totrans-534
  prefs: []
  type: TYPE_NORMAL
  zh: 你应该看到以下输出：
- en: '[PRE145]'
  id: totrans-535
  prefs: []
  type: TYPE_PRE
  zh: '[PRE145]'
- en: Running the Jenkins container
  id: totrans-536
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 运行 Jenkins 容器
- en: 'Now that we have our Docker host ready, let''s run Jenkins:'
  id: totrans-537
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们的 Docker 主机已准备好，让我们运行 Jenkins：
- en: 'Run the following command to start a Jenkins container. This might take some
    time, as Docker will try to download the Jenkins Docker image (`jenkins/jenkins:lts`)
    from Docker Hub:'
  id: totrans-538
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行以下命令以启动 Jenkins 容器。这可能需要一些时间，因为 Docker 将尝试从 Docker Hub 下载 Jenkins Docker 镜像
    (`jenkins/jenkins:lts`)：
- en: '[PRE146]'
  id: totrans-539
  prefs: []
  type: TYPE_PRE
  zh: '[PRE146]'
- en: 'You should see the following output:'
  id: totrans-540
  prefs: []
  type: TYPE_NORMAL
  zh: 你应该看到以下输出：
- en: '[PRE147]'
  id: totrans-541
  prefs: []
  type: TYPE_PRE
  zh: '[PRE147]'
- en: 'The following table explains the Docker command that we used in the previous
    command:'
  id: totrans-542
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以下表格解释了我们在上一个命令中使用的 Docker 命令：
- en: '| **Parameters** | **Description** |'
  id: totrans-543
  prefs: []
  type: TYPE_TB
  zh: '| **参数** | **描述** |'
- en: '| `docker` | Used to invoke the Docker utility. |'
  id: totrans-544
  prefs: []
  type: TYPE_TB
  zh: '| `docker` | 用于调用 Docker 实用程序。 |'
- en: '| `run` | A Docker command to run a container. |'
  id: totrans-545
  prefs: []
  type: TYPE_TB
  zh: '| `run` | 用于运行容器的 Docker 命令。 |'
- en: '| `-d` | This option runs the container in the backend. |'
  id: totrans-546
  prefs: []
  type: TYPE_TB
  zh: '| `-d` | 此选项在后台运行容器。 |'
- en: '| `--name` | This option allows you to give your container a name. |'
  id: totrans-547
  prefs: []
  type: TYPE_TB
  zh: '| `--name` | 此选项允许您为容器命名。 |'
- en: '| `-p` | This option is used to map a container''s port with the host. |'
  id: totrans-548
  prefs: []
  type: TYPE_TB
  zh: '| `-p` | 该选项用于将容器的端口与主机映射。 '
- en: '| `jenkins/jenkins:lts` | The name of the Docker image and its version used
    to create a container. `jenkins/jenkins` is the Jenkins Docker image, and `lts`
    is a particular version of that image. |'
  id: totrans-549
  prefs: []
  type: TYPE_TB
  zh: '| `jenkins/jenkins:lts` | 用于创建容器的 Docker 镜像及其版本的名称。 `jenkins/jenkins` 是 Jenkins
    Docker 镜像，`lts` 是该镜像的特定版本。 |'
- en: 'To see the list of running containers, execute the following command:'
  id: totrans-550
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要查看正在运行的容器列表，请执行以下命令：
- en: '[PRE148]'
  id: totrans-551
  prefs: []
  type: TYPE_PRE
  zh: '[PRE148]'
- en: 'You should see the following output:'
  id: totrans-552
  prefs: []
  type: TYPE_NORMAL
  zh: 您应该看到以下输出：
- en: '[PRE149]'
  id: totrans-553
  prefs: []
  type: TYPE_PRE
  zh: '[PRE149]'
- en: To use the latest LTS release of Jenkins, use the `jenkins/jenkins:lts` Jenkins
    Docker image.
  id: totrans-554
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用 Jenkins 的最新 LTS 版本，请使用 `jenkins/jenkins:lts` Jenkins Docker 镜像。
- en: To use the latest weekly release of Jenkins, use the `jenkins/jenkins` Jenkins
    Docker image.
  id: totrans-555
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用 Jenkins 的最新每周发布版本，请使用 `jenkins/jenkins` Jenkins Docker 镜像。
- en: 'Make a note of your Docker host IP using the following command:'
  id: totrans-556
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令记下您的 Docker 主机 IP：
- en: '[PRE150]'
  id: totrans-557
  prefs: []
  type: TYPE_PRE
  zh: '[PRE150]'
- en: 'You should see the following output:'
  id: totrans-558
  prefs: []
  type: TYPE_NORMAL
  zh: 您应该看到以下输出：
- en: '[PRE151]'
  id: totrans-559
  prefs: []
  type: TYPE_PRE
  zh: '[PRE151]'
- en: Your Jenkins server is now available on `http:<IP Address of Docker host>:8080`.
    You should now be able to see the Jenkins Getting Started page.
  id: totrans-560
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您的 Jenkins 服务器现在可通过`http：<Docker 主机的 IP 地址>：8080`访问。现在您应该能够看到 Jenkins 入门页面。
- en: 'To proceed with the Jenkins setup, you might need the `initialAdminPassword`
    key. This file is inside `/var/jenkins_home/secrets/`. There are two ways you
    can get the data inside the `initialAdminPassword` file. You can use the `docker
    exec` command, as illustrated here:'
  id: totrans-561
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要继续进行 Jenkins 设置，您可能需要`initialAdminPassword`密钥。此文件位于`/var/jenkins_home/secrets/`内。您可以通过以下方式之一获取`initialAdminPassword`文件内的数据。您可以使用以下命令`docker
    exec`，如下所示：
- en: '[PRE152]'
  id: totrans-562
  prefs: []
  type: TYPE_PRE
  zh: '[PRE152]'
- en: 'Or, by logging inside the running Jenkins container, using the same `docker
    exec` command, as shown here:'
  id: totrans-563
  prefs: []
  type: TYPE_NORMAL
  zh: 或者，通过登录到正在运行的 Jenkins 容器内，使用相同的`docker exec`命令，如下所示：
- en: '[PRE153]'
  id: totrans-564
  prefs: []
  type: TYPE_PRE
  zh: '[PRE153]'
- en: 'Once you are inside the container, execute the following Linux command to get
    the contents of the file:'
  id: totrans-565
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦您进入容器，请执行以下 Linux 命令以获取文件的内容：
- en: '[PRE154]'
  id: totrans-566
  prefs: []
  type: TYPE_PRE
  zh: '[PRE154]'
- en: 'Both the commands will print the content of the `initialAdminPassword` file,
    similar to the one shown as follows:'
  id: totrans-567
  prefs: []
  type: TYPE_NORMAL
  zh: 这两个命令都会打印`initialAdminPassword`文件的内容，类似于以下所示的内容：
- en: '[PRE155]'
  id: totrans-568
  prefs: []
  type: TYPE_PRE
  zh: '[PRE155]'
- en: Here, the `-i` option allows you to interact with your Docker container and
    the `-t` option allocates a pseudo `-tty`.
  id: totrans-569
  prefs: []
  type: TYPE_NORMAL
  zh: 这里，`-i` 选项允许您与 Docker 容器进行交互，而 `-t` 选项分配一个伪 `-tty`。
- en: While you are still inside the Jenkins container, notice that the `jenkins_home`
    directory is present inside the `/var/` directory and the `jenkins.war` file is
    located inside `/usr/share/jenkins`.
  id: totrans-570
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当您仍在 Jenkins 容器内时，请注意`jenkins_home`目录位于`/var/`内，并且`jenkins.war`文件位于`/usr/share/jenkins`内。
- en: The `jenkins_home` is a very important directory where all your Jenkins jobs,
    builds, metadata, configurations, users, and everything, are stored.
  id: totrans-571
  prefs: []
  type: TYPE_NORMAL
  zh: '`jenkins_home` 是一个非常重要的目录，其中包含您的 Jenkins 作业、构建、元数据、配置、用户等所有内容。'
- en: Running a Jenkins container using a data volume
  id: totrans-572
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用数据卷运行 Jenkins 容器
- en: In the previous sections, we created a Jenkins container without a mechanism
    to make the data inside the `jenkins_home` directory persistent. In simple words,
    if for some reason you delete the Jenkins container, you delete your `jenkins_home`
    directory.
  id: totrans-573
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的部分中，我们创建了一个 Jenkins 容器，但没有任何机制使`jenkins_home`目录内的数据持久化。简单来说，如果由于某种原因删除 Jenkins
    容器，则会删除您的`jenkins_home`目录。
- en: Luckily, there is still a better way to run Jenkins with Docker, and that is
    by using data volumes. Data volumes are special directories that make the data
    persistent and independent of the container's life cycle. If a container writes
    data to a data volume, deleting the container will still make the data available
    because the container and its associated data volume are two different entities.
  id: totrans-574
  prefs: []
  type: TYPE_NORMAL
  zh: 幸运的是，还有一种更好的方法来使用 Docker 运行 Jenkins，那就是使用数据卷。数据卷是特殊的目录，使数据持久化并独立于容器的生命周期。如果容器将数据写入数据卷，则删除容器仍会使数据可用，因为容器及其关联的数据卷是两个不同的实体。
- en: 'Let''s create a Jenkins container using a data volume:'
  id: totrans-575
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们使用数据卷创建一个 Jenkins 容器：
- en: 'Run a Jenkins container using the following command:'
  id: totrans-576
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令运行 Jenkins 容器：
- en: '[PRE156]'
  id: totrans-577
  prefs: []
  type: TYPE_PRE
  zh: '[PRE156]'
- en: The `-v jenkins-home-prod:/var/jenkins_home` option will create a data volume
    named `jenkins-home-prod` and will map it to the `/var/jenkins_home` directory inside
    the container.
  id: totrans-578
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`-v jenkins-home-prod:/var/jenkins_home` 选项将创建一个名为`jenkins-home-prod`的数据卷，并将其映射到容器内的`/var/jenkins_home`目录。'
- en: 'Execute the following command to see the contents of the `/var/jenkins_home`
    directory inside the `jenkins_prod` Jenkins container:'
  id: totrans-579
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 执行以下命令以查看 `jenkins_prod` Jenkins 容器内 `/var/jenkins_home` 目录的内容：
- en: '[PRE157]'
  id: totrans-580
  prefs: []
  type: TYPE_PRE
  zh: '[PRE157]'
- en: 'You should see the following output:'
  id: totrans-581
  prefs: []
  type: TYPE_NORMAL
  zh: 您应该看到以下输出：
- en: '[PRE158]'
  id: totrans-582
  prefs: []
  type: TYPE_PRE
  zh: '[PRE158]'
- en: 'To list your Docker volume, execute the following command:'
  id: totrans-583
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要列出您的 Docker 卷，请执行以下命令：
- en: '[PRE159]'
  id: totrans-584
  prefs: []
  type: TYPE_PRE
  zh: '[PRE159]'
- en: 'You should see the following output:'
  id: totrans-585
  prefs: []
  type: TYPE_NORMAL
  zh: 您应该看到以下输出：
- en: '[PRE160]'
  id: totrans-586
  prefs: []
  type: TYPE_PRE
  zh: '[PRE160]'
- en: Now you have a Jenkins container with a persistent `jenkins_home` directory.
  id: totrans-587
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在您有一个带有持久 `jenkins_home` 目录的 Jenkins 容器。
- en: Testing the data volume
  id: totrans-588
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 测试数据卷
- en: 'We will test our data volume by performing the following steps:'
  id: totrans-589
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将通过执行以下步骤来测试我们的数据卷。
- en: We will make some changes on our Jenkins server; this will modify the content
    inside the `/var/jenkins_home` directory.
  id: totrans-590
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们将对 Jenkins 服务器进行一些更改；这将修改 `/var/jenkins_home` 目录中的内容。
- en: We will delete the Jenkins container.
  id: totrans-591
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们将删除 Jenkins 容器。
- en: We will create a new Jenkins container that will use the same data volume.
  id: totrans-592
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们将创建一个新的 Jenkins 容器，该容器将使用相同的数据卷。
- en: 'Check for the active Jenkins container using the following command:'
  id: totrans-593
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令检查活动的 Jenkins 容器：
- en: '[PRE161]'
  id: totrans-594
  prefs: []
  type: TYPE_PRE
  zh: '[PRE161]'
- en: 'You should see the following output:'
  id: totrans-595
  prefs: []
  type: TYPE_NORMAL
  zh: 您应该看到以下输出：
- en: '[PRE162]'
  id: totrans-596
  prefs: []
  type: TYPE_PRE
  zh: '[PRE162]'
- en: Access the Jenkins server using `http://<ip address of docker host>:8080`.
  id: totrans-597
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 `http://<Docker 主机的 IP 地址>:8080` 访问 Jenkins 服务器。
- en: 'Get the contents of the `initialAdminPassword`  file using the following command:'
  id: totrans-598
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令获取 `initialAdminPassword` 文件的内容：
- en: '[PRE163]'
  id: totrans-599
  prefs: []
  type: TYPE_PRE
  zh: '[PRE163]'
- en: 'You should see the following output:'
  id: totrans-600
  prefs: []
  type: TYPE_NORMAL
  zh: 您应该看到以下输出：
- en: '[PRE164]'
  id: totrans-601
  prefs: []
  type: TYPE_PRE
  zh: '[PRE164]'
- en: Paste the `initialAdminPassword` under the Administrator password field on the
    Jenkins page and proceed with the Jenkins setup.
  id: totrans-602
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 Jenkins 页面的管理员密码字段下粘贴 `initialAdminPassword` 并继续进行 Jenkins 设置。
- en: 'Create a new user at the Create First Admin User step, as shown in the following
    screenshot:'
  id: totrans-603
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在创建第一个管理员用户步骤中创建一个新用户，如下所示的截图：
- en: '![](img/7e5005a6-ceda-46d4-a968-edb72ea1ff52.png)'
  id: totrans-604
  prefs: []
  type: TYPE_IMG
  zh: '![](img/7e5005a6-ceda-46d4-a968-edb72ea1ff52.png)'
- en: Creating the first admin user on Jenkins
  id: totrans-605
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Jenkins 上创建第一个管理员用户
- en: Proceed with the remaining steps.
  id: totrans-606
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 继续进行剩余的步骤。
- en: 'Execute the following command to list the content of the `/var/jenkins_home/users`
    directory. This the is location where you have all the user accounts:'
  id: totrans-607
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 执行以下命令以列出 `/var/jenkins_home/users` 目录的内容。这是您拥有所有用户帐户的位置：
- en: '[PRE165]'
  id: totrans-608
  prefs: []
  type: TYPE_PRE
  zh: '[PRE165]'
- en: 'Output should be as follows:'
  id: totrans-609
  prefs: []
  type: TYPE_NORMAL
  zh: 输出应该如下所示：
- en: '[PRE166]'
  id: totrans-610
  prefs: []
  type: TYPE_PRE
  zh: '[PRE166]'
- en: Notice our newly created user developer is listed under the `users` directory.
  id: totrans-611
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 注意我们新创建的用户 developer 在 `users` 目录下列出。
- en: 'Now let''s delete the `jenkins_prod` Jenkins container using the following
    commands:'
  id: totrans-612
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在让我们使用以下命令删除 `jenkins_prod` Jenkins 容器：
- en: '[PRE167]'
  id: totrans-613
  prefs: []
  type: TYPE_PRE
  zh: '[PRE167]'
- en: 'List the existing Docker containers (running/stopped) using the following command:'
  id: totrans-614
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令列出现有的 Docker 容器（运行/停止）：
- en: '[PRE168]'
  id: totrans-615
  prefs: []
  type: TYPE_PRE
  zh: '[PRE168]'
- en: 'You should see the following output. However, you shouldn''t see `jenkins_prod`
    in the list:'
  id: totrans-616
  prefs: []
  type: TYPE_NORMAL
  zh: 您应该看到以下输出。但是，您不应该在列表中看到 `jenkins_prod`：
- en: '[PRE169]'
  id: totrans-617
  prefs: []
  type: TYPE_PRE
  zh: '[PRE169]'
- en: 'List the volumes using the following command:'
  id: totrans-618
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令列出卷的内容：
- en: '[PRE170]'
  id: totrans-619
  prefs: []
  type: TYPE_PRE
  zh: '[PRE170]'
- en: 'You should see something similar. You can see that deleting the container did
    not delete its associated data volume:'
  id: totrans-620
  prefs: []
  type: TYPE_NORMAL
  zh: 您应该看到类似的内容。您可以看到删除容器并没有删除其关联的数据卷：
- en: '[PRE171]'
  id: totrans-621
  prefs: []
  type: TYPE_PRE
  zh: '[PRE171]'
- en: 'Now let''s create a new Jenkins container named `jenkins_prod` that uses the
    existing `jenkins-home-prod` volume:'
  id: totrans-622
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在让我们创建一个名为 `jenkins_prod` 的新 Jenkins 容器，该容器使用现有的 `jenkins-home-prod` 卷：
- en: '[PRE172]'
  id: totrans-623
  prefs: []
  type: TYPE_PRE
  zh: '[PRE172]'
- en: Try to access the Jenkins dashboard using `http://<IP Address of Docker host>:8080`.
    You will not see the Jenkins setup page; instead, you should see the login page.
  id: totrans-624
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 尝试访问 Jenkins 仪表板，使用 `http://<Docker 主机的 IP 地址>:8080`。您将看不到 Jenkins 设置页面；相反，您应该看到登录页面。
- en: Log in to Jenkins using the user that we created earlier. You should be able
    to log in. This proves that our entire Jenkins configuration is intact.
  id: totrans-625
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用我们之前创建的用户登录 Jenkins。您应该能够登录。这证明我们的整个 Jenkins 配置是完好的。
- en: Creating development and staging instances of Jenkins
  id: totrans-626
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建 Jenkins 的开发和分段实例
- en: Many times you are in need of a development or a staging instance of your Jenkins
    production server to test something new. Docker makes it easy and safe to create
    multiple instances of your Jenkins servers.
  id: totrans-627
  prefs: []
  type: TYPE_NORMAL
  zh: 许多时候，您需要一个 Jenkins 生产服务器的开发或分段实例来测试新功能。Docker 可以轻松且安全地创建多个 Jenkins 服务器实例。
- en: Here is how to do it. In this section, we will create a development and a staging
    instance of Jenkins using our Jenkins production instance.
  id: totrans-628
  prefs: []
  type: TYPE_NORMAL
  zh: 下面是如何做的。在此部分中，我们将使用我们的 Jenkins 生产实例创建一个开发和一个分段实例。
- en: Prerequisites
  id: totrans-629
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 先决条件
- en: 'Before we begin, make sure you have the following things ready:'
  id: totrans-630
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们开始之前，请确保您准备好以下内容：
- en: We need a Docker host running a Jenkins instance (production), utilizing data
    volumes
  id: totrans-631
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们需要一个运行 Jenkins 实例（生产）并利用数据卷的 Docker 主机
- en: Refer to the *Running a Jenkins container using a data volume *section
  id: totrans-632
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 参考*使用数据卷运行 Jenkins 容器*部分
- en: Creating an empty data volume
  id: totrans-633
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建一个空数据卷
- en: 'We will create a data volume named `jenkins-home-staging` and `jenkins-home-development`
    for our staging and development instances of Jenkins, respectively:'
  id: totrans-634
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将为我们的 Jenkins 的暂存和开发实例分别创建名为`jenkins-home-staging`和`jenkins-home-development`的数据卷：
- en: 'To create an empty `jenkins-home-staging` data volume, run the following command:'
  id: totrans-635
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要创建一个空的`jenkins-home-staging`数据卷，请运行以下命令：
- en: '[PRE173]'
  id: totrans-636
  prefs: []
  type: TYPE_PRE
  zh: '[PRE173]'
- en: 'To create an empty `jenkins-home-development` data volume, run the following
    command:'
  id: totrans-637
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要创建一个空的`jenkins-home-development`数据卷，请运行以下命令：
- en: '[PRE174]'
  id: totrans-638
  prefs: []
  type: TYPE_PRE
  zh: '[PRE174]'
- en: 'List the newly create data volumes using the `docker volume` command:'
  id: totrans-639
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`docker volume`命令列出新创建的数据卷：
- en: '[PRE175]'
  id: totrans-640
  prefs: []
  type: TYPE_PRE
  zh: '[PRE175]'
- en: 'You should see the following output:'
  id: totrans-641
  prefs: []
  type: TYPE_NORMAL
  zh: 您应该看到以下输出：
- en: '[PRE176]'
  id: totrans-642
  prefs: []
  type: TYPE_PRE
  zh: '[PRE176]'
- en: From the previous list, you can see the newly created data volumes named `jenkins-home-staging`
    and `jenkins-home-development`.
  id: totrans-643
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从前面的列表中，您可以看到新创建的名为`jenkins-home-staging`和`jenkins-home-development`的数据卷。
- en: If you have followed the previous section, you should also see the data volume
    `jenkins-home-prod` that is being used by our Jenkins production instance `jenkins_prod`.
  id: totrans-644
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您已经按照前一节的步骤进行了操作，您还应该看到正在由我们的 Jenkins 生产实例`jenkins_prod`使用的数据卷`jenkins-home-prod`。
- en: Copying data between data volumes
  id: totrans-645
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在数据卷之间复制数据
- en: 'We now have our newly created empty data volumes. Let''s copy the content of
    `jenkins-home-prod` to each of them:'
  id: totrans-646
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们有了新创建的空数据卷。让我们将`jenkins-home-prod`的内容复制到每一个数据卷：
- en: 'Copy the content of `jenkins-home-prod` to `jenkins-home-staging` using the
    following command:'
  id: totrans-647
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令将`jenkins-home-prod`的内容复制到`jenkins-home-staging`：
- en: '[PRE177]'
  id: totrans-648
  prefs: []
  type: TYPE_PRE
  zh: '[PRE177]'
- en: 'The previous command will do the following:'
  id: totrans-649
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 前一个命令将执行以下操作：
- en: It will first create an interactive container using the Docker image for Jenkins
    `jenkins/jenkins:lts` (the container is temporary).
  id: totrans-650
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 它首先将使用 Jenkins 的 Docker 镜像`jenkins/jenkins:lts`创建一个交互式容器（容器是临时的）。
- en: All actions performed on this temporary container will be using the `root` user.
    Notice the `--user root` option in the previous command.
  id: totrans-651
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在这个临时容器上执行的所有操作都将使用`root`用户。注意前一个命令中的`--user root`选项。
- en: It will mount the content of the  `jenkins-home-prod` data volume onto the `/var/jenkins_home` directory present
    inside the container. Notice the `-v jenkins-home-prod:/var/jenkins_home` option.
  id: totrans-652
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 它将`jenkins-home-prod`数据卷的内容挂载到容器内的`/var/jenkins_home`目录中。注意`-v jenkins-home-prod:/var/jenkins_home`选项。
- en: Similarly, it will mount the non-existing content of the `jenkins-home-staging` data
    volume onto the non-existing `/var/jenkins_home_staging` directory inside the
    container. Notice the `-v jenkins-home-staging:/var/jenkins_home_staging` option.
  id: totrans-653
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 类似地，它将`jenkins-home-staging`数据卷的不存在内容挂载到容器内不存在的`/var/jenkins_home_staging`目录中。注意`-v
    jenkins-home-staging:/var/jenkins_home_staging`选项。
- en: It will then, copy the content of `/var/jenkins_home` to `/var/jenkins_home_staging`.
    Notice the `bash -c "cd /var/jenkins_home_staging && cp -a /var/jenkins_home/*"`
    option.
  id: totrans-654
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 然后，它将`/var/jenkins_home`的内容复制到`/var/jenkins_home_staging`。注意`bash -c "cd /var/jenkins_home_staging
    && cp -a /var/jenkins_home/*"`选项。
- en: 'Now, copy the content of `jenkins-home-prod` to `jenkins-home-development`
    using the following command:'
  id: totrans-655
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，使用以下命令将`jenkins-home-prod`的内容复制到`jenkins-home-development`：
- en: '[PRE178]'
  id: totrans-656
  prefs: []
  type: TYPE_PRE
  zh: '[PRE178]'
- en: 'Now we have the same data on all the three data volumes: `jenkins-home-prod`,
    `jenkins-home-staging`, and `jenkins-home-development`.'
  id: totrans-657
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在我们在所有三个数据卷上都有相同的数据：`jenkins-home-prod`、`jenkins-home-staging`和`jenkins-home-development`。
- en: Creating the development and staging instances
  id: totrans-658
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建开发和暂存实例
- en: 'Now that we have data volumes for development and staging, let''s spawn the
    containers using them:'
  id: totrans-659
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经为开发和暂存准备好了数据卷，让我们使用它们生成容器：
- en: 'To create a Jenkins staging instance named `jenkins_staging` using the  `jenkins-home-staging` data
    volume, run the following command:'
  id: totrans-660
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要创建名为`jenkins_staging`的 Jenkins 暂存实例，并使用`jenkins-home-staging`数据卷，请运行以下命令：
- en: '[PRE179]'
  id: totrans-661
  prefs: []
  type: TYPE_PRE
  zh: '[PRE179]'
- en: The previous command will create a Jenkins instance running on port `8080` and
    mapped to port `8081` of the Docker host. We choose a different port on Docker
    host because we already have our Jenkins production instance, `jenkins_prod`,
    running on port `8080`, which is mapped to port `8080` of the Docker host.
  id: totrans-662
  prefs: []
  type: TYPE_NORMAL
  zh: 前一个命令将创建一个运行在端口`8080`上的 Jenkins 实例，并将其映射到 Docker 主机的端口`8081`。我们选择 Docker 主机上的不同端口，因为我们已经有我们的
    Jenkins 生产实例`jenkins_prod`运行在端口`8080`上，该端口映射到 Docker 主机的端口`8080`。
- en: The same reason applies to mapping port `50000` on the Jenkins instance to port
    `50001` on the Docker host.
  id: totrans-663
  prefs: []
  type: TYPE_NORMAL
  zh: 相同的原因也适用于将 Jenkins 实例上的端口`50000`映射到 Docker 主机上的端口`50001`。
- en: Try to access your Jenkins staging instance using `http:<IP Address of Docker
    host>:8081`.
  id: totrans-664
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 尝试使用`http：<Docker 主机的 IP 地址>：8081`访问您的 Jenkins 暂存实例。
- en: 'Similarly, to create a Jenkins development instance named `jenkins_development`
    using the  `jenkins-home-development` data volume, run the following command:'
  id: totrans-665
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 同样地，要使用 `jenkins-home-development` 数据卷创建一个名为 `jenkins_development` 的 Jenkins
    开发实例，请运行以下命令：
- en: '[PRE180]'
  id: totrans-666
  prefs: []
  type: TYPE_PRE
  zh: '[PRE180]'
- en: The previous command will create a Jenkins instance running on port `8080` and
    mapped to port `8082` of the Docker host. We choose a different port on the Docker
    host because port `8080` and `8081` are already in use on the Docker host.
  id: totrans-667
  prefs: []
  type: TYPE_NORMAL
  zh: 上一个命令将创建一个运行在端口 `8080` 上并映射到 Docker 主机端口 `8082` 的 Jenkins 实例。我们选择 Docker 主机上的不同端口，因为端口
    `8080` 和 `8081` 已经在 Docker 主机上被使用了。
- en: The same reason applies to mapping port `50000` on the Jenkins instance to port
    `50002` on the Docker host.
  id: totrans-668
  prefs: []
  type: TYPE_NORMAL
  zh: 同样的理由也适用于将 Jenkins 实例上的端口 `50000` 映射到 Docker 主机上的端口 `50002`。
- en: Try to access your Jenkins development instance using `http:<IP Address of Docker
    host>:8082`.
  id: totrans-669
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 尝试使用 `http:<Docker 主机的 IP 地址>:8082` 访问您的 Jenkins 开发实例。
- en: Summary
  id: totrans-670
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, we learned how to install Jenkins on an Apache Tomcat server
    and as a standalone application on various operating systems. We also learned
    how to set up a reverse proxy server (Nginx) in front of our Jenkins server and
    secured the connection using SSL.
  id: totrans-671
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们学习了如何在 Apache Tomcat 服务器上安装 Jenkins，以及如何在各种操作系统上作为独立应用程序安装 Jenkins。我们还学习了如何在
    Jenkins 服务器前面设置一个反向代理服务器（Nginx），并使用 SSL 安全连接。
- en: Above all, we learned how to run Jenkins on Docker. We also saw the advantages
    of using data volumes on Docker and learned how to leverage them to create on-demand
    instances (development or staging) of our Jenkins server.
  id: totrans-672
  prefs: []
  type: TYPE_NORMAL
  zh: 最重要的是，我们学会了如何在 Docker 上运行 Jenkins。我们还看到了在 Docker 上使用数据卷的优势，并学习了如何利用它们来创建我们 Jenkins
    服务器的按需实例（开发或者预备环境）。
- en: The main objective of the current chapter was to show the readers how diverse
    Jenkins is in many ways when it comes to the installation process and the variety
    of operating systems that it supports. The Jenkins administration will be discussed
    in [Chapter 4](89cbc75b-c9e8-41b8-8657-aab37e6e7ad4.xhtml), *Configuring Jenkins*.
  id: totrans-673
  prefs: []
  type: TYPE_NORMAL
  zh: 当前章节的主要目标是向读者展示 Jenkins 在安装过程和支持的操作系统种类方面的多样性。Jenkins 管理将在[第四章](89cbc75b-c9e8-41b8-8657-aab37e6e7ad4.xhtml)中讨论，*配置
    Jenkins*。
- en: In the next chapter, we will have a quick overview of what's new in Jenkins
    2.x.
  id: totrans-674
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将快速概述 Jenkins 2.x 中的新特性。
